<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8" />
	<title>Documentation - SQL &amp; first introduction</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta name="description" content="" />
	<meta name="author" content="" />
	<!-- Le styles -->
	<!-- Latest compiled and minified CSS -->
	<link href="assets/css/bootstrap.css" rel="stylesheet" />
	<link href="assets/css/bootstrap-responsive.css" rel="stylesheet" />
	<link href="assets/google-code-prettify/prettify.css" rel="stylesheet" />
	<link href="assets/css/docs.css" rel="stylesheet" />
	<link href="assets/css/docs-panels.css" rel="stylesheet" />
	<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
	<!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
	<!-- Le fav and touch icons -->
	<link rel="shortcut icon" href="assets/img/code.png" />
	<style>
		.pluginwrap {
			display: none;
		}

		.pluginwrapActive {
			display: block;
		}
	</style>
</head>

<body>
	<!-- Subhead
        ================================================== -->
	<header class="jumbotron subhead">
		<div class="container container-narrow">
			<a href="http://www.bnextconsulting.com/">
				<img src=https://www.bnext.pt/Image/banner_bnext_598px.jpg>
		</div>
	</header>
	<div class="container">
		<div class="row">
			<div class="span12">
				<div class="well intro-text">
					<h3>Welcome! This supplement will help you get started writing SQL queries.</h3>
					<p>
						If you have any questions about this tutorial, please email us at
						<a href="mailto:suporte@bnextconsulting.com">suporte@bnextconsulting.com</a>.
					</p>
				</div>
			</div>
		</div>
		<div class="row" style="margin-top:20px;margin-bottom:20px">
			<div class="span12">
				<table class="table table-bordered table-striped">
					<tbody>
						<tr>
							<td width="30%">
								<h4>Table of Contents:</h4>
								<ul class="menu">
									<li><a href="javascript:;" class="clickable" data-section="#select">1. Select</a>
									</li>
									<li><a href="javascript:;" class="clickable" data-section="#calculations">2.
											Calculations</a></li>
									<li><a href="javascript:;" class="clickable" data-section="#where">3. Where</a></li>
									<li><a href="javascript:;" class="clickable" data-section="#joins">4. Joins</a></li>
									<li><a href="javascript:;" class="clickable" data-section="#group-by">5. Group
											By</a></li>
									<li><a href="javascript:;" class="clickable" data-section="#having">6. Having</a>
									</li>
									<li><a href="javascript:;" class="clickable" data-section="#order-by">7. Order
											By</a></li>
									<li><a href="javascript:;" class="clickable" data-section="#parameters">8.
											Parameters</a></li>
									<li><a href="javascript:;" class="clickable" data-section="#views">9. Views</a>
									</li>
									<li><a href="javascript:;" class="clickable" data-section="#metadata">10.
											Metadata</a></li>
									<li><a href="javascript:;" class="clickable" data-section="#subqueries">11.
											Subqueries</a></li>
									<li><a href="javascript:;" class="clickable" data-section="#set-operations">12. Set
											Operations</a></li>
									<li><a href="javascript:;" class="clickable" data-section="#with-blocks">13. With
											Blocks</a></li>
									<li><a href="javascript:;" class="clickable" data-section="#window-functions">14.
											Window Functions</a></li>
									<li><a href="javascript:;" class="clickable"
											data-section="#user-defined-functions">15. User Defined Functions</a></li>
									<li><a href="javascript:;" class="clickable" data-section="#top-n">16. Top N</a>
									</li>
								</ul>
							</td>
							<td width="70%">
								<ul class="menu">
									<h4>Overview</h4>
									<p>
										This is a companion document to the SQL;
									</p>
									<ul>
										<li>Syntax Examples</li>
										<li>Practice Exercises</li>
									</ul>
									<hr>
								</ul>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>

		<div class="row">
			<div class="span12">


				<section id="select">
					<div class="page-header">
						<h1>Select</h1>
						<a href="javascript:;">To top <i class="icon-arrow-up"></i></a>
					</div>
				</section>

				<h3>Syntax Review</h3>

				<div class="syntax">

					<p>Basic queries require only a <strong>select</strong> clause. These simple queries can output back
						values you provide as input.</p>
					<ul>
						<li>Text</li>
						<li>Number</li>
						<li>Date/Time</li>
						<li>Function Result</li>
					</ul>
					<p>In Oracle, all queries must be made against a table. Oracle provides a dummy table called dual,
						which is a single column, single row dummy table that you can query against.</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Example
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-2048685333" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-2048685333" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-2048685333" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-2048685333" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-2048685333">
										<pre class="prettyprint linenums">select    'Hello World'</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-2048685333">
										<pre class="prettyprint linenums">select    'Hello World from dual</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-2048685333">
										<pre class="prettyprint linenums">select    'Hello World'</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-2048685333">
										<pre class="prettyprint linenums">select    'Hello World'</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>

				<div class="syntax">

					<p>Multiple columns are separated by commas.</p>

					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Example
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-310045095" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-310045095" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-310045095" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-310045095" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-310045095">
										<pre class="prettyprint linenums">select    'Hello World',
          123,
          sysdatetime()</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-310045095">
										<pre class="prettyprint linenums">select    'Hello World',
          123,
          sysdate
from      dual</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-310045095">
										<pre class="prettyprint linenums">select    'Hello World',
          123,
          now()</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-310045095">
										<pre class="prettyprint linenums">select    'Hello World',
          123,
          now()</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">

					<p>You can use aliases to change the names of the columns in the output.</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Example
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-1954518847" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-1954518847" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-1954518847" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-1954518847" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-1954518847">
										<pre class="prettyprint linenums">select    'Hello World' as text_column,
          123 as number_column,
          sysdatetime() as date_time_column</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-1954518847">
										<pre class="prettyprint linenums">select    'Hello World' as text_column,
          123 as number_column,
          sysdate as date_time_column
from      dual</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-1954518847">
										<pre class="prettyprint linenums">select    'Hello World' as text_column,
          123 as number_column,
          now() as date_time_column</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-1954518847">
										<pre class="prettyprint linenums">select    'Hello World' as text_column,
          123 as number_column,
          now() as date_time_column</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">

					<p>You can select all columns from a table using the * character.</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Example
						</div>
						<div class="panel-body">
							<div>


								<pre class="prettyprint linenums">select    *
from      countries</pre>


							</div>
						</div>
					</div>

				</div>




				<h3>Exercises</h3>







				<div class="exercise bottom20">

					<ol>
						<li>Select the MovieId, Title and ReleaseDate columns from the Movies table.</li>
					</ol>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-2112234152" aria-expanded="false"
						aria-controls="collapse-aria-controls-2112234152">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-2112234152">


						<pre class="prettyprint linenums">select    MovieId,
          Title,
          ReleaseDate
from      Movies</pre>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="2">
						<li>Reverse the display order of the columns in the previous exercise.</li>
					</ol>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-374413729" aria-expanded="false"
						aria-controls="collapse-aria-controls-374413729">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-374413729">


						<pre class="prettyprint linenums">select    ReleaseDate,
          Title,
          MovieId
from      Movies</pre>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="3">
						<li>Select the Title column from the Movies table, but alias the Title column to TheMovieTitle.
						</li>
					</ol>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-2053479709" aria-expanded="false"
						aria-controls="collapse-aria-controls-2053479709">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-2053479709">


						<pre class="prettyprint linenums">select    Title as TheMovieTitle
from      Movies</pre>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="4">
						<li>Select all columns from the Actors table.</li>
					</ol>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-588263720" aria-expanded="false"
						aria-controls="collapse-aria-controls-588263720">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-588263720">


						<pre class="prettyprint linenums">select    *
from      Actors</pre>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="5">
						<li>Repeat the last example where the entire query is in uppercase letters.</li>
					</ol>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-710186851" aria-expanded="false"
						aria-controls="collapse-aria-controls-710186851">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-710186851">


						<pre class="prettyprint linenums">select    *
from      ACTORS</pre>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="6">
						<li>Repeat the last query where the entire query is in lowercase letters.</li>
					</ol>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-105203390" aria-expanded="false"
						aria-controls="collapse-aria-controls-105203390">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-105203390">


						<pre class="prettyprint linenums">select    *
from      actors</pre>


					</div>

				</div>





				<section id="calculations">
					<div class="page-header">
						<h1>Calculations</h1>
						<a href="javascript:;">To top <i class="icon-arrow-up"></i></a>
					</div>
				</section>


				<h3>Syntax Review</h3>





				<div class="syntax">

					<p>Expressions are the most generic term that can be used to describe:</p>
					<ul>
						<li>Strings (text)</li>
						<li>Numbers</li>
						<li>Date/Times</li>
						<li>Function results including date extractions</li>
						<li>String concatenation</li>
					</ul>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Example
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-1482772538" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-1482772538" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-1482772538" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-1482772538" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-1482772538">
										<pre class="prettyprint linenums">select    1 + 2 as numeric_expression,
          'a' + 'b' as string_expression,
          SysDateTime() as function_expression,
          DatePart(Month, SysDateTime()) as month_extraction_expression,
          DatePart(Year, SysDateTime()) as year_extraction_expression,
          Power(2, 3) as math_function_expression</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-1482772538">
										<pre class="prettyprint linenums">select    1 + 2 as numeric_expression,
          'a' || 'b' as string_expression,
          SysDate as function_expression,
          extract(Month from SysDate) as month_extraction_expression,
          extract(Year from SysDate) as year_extraction_expression,
          Power(2, 3) as math_function_expression
from      dual</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-1482772538">
										<pre class="prettyprint linenums">select    1 + 2 as numeric_expression,
          concat('a', 'b') as string_expression,
          Now() as function_expression,
          Month(Now()) as month_extraction_expression,
          Year(Now()) as year_extraction_expression,
          Power(2, 3) as math_function_expression</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-1482772538">
										<pre class="prettyprint linenums">select    1 + 2 as numeric_expression,
          'a' || 'b' as string_expression,
          Now() as function_expression,
          extract(Month from Now()) as month_extraction_expression,
          extract(Year from Now()) as year_extraction_expression,
          Power(2, 3) as math_function_expression</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">

					<p>Extracting date fields is a common requirement when querying. These examples illustrate how to
						find the year component of a date/time value.</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Example
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-758131761" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-758131761" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-758131761" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-758131761" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-758131761">
										<pre class="prettyprint linenums">select    Title,
          DatePart(Year, ReleaseDate) as ReleaseYear
from      Movies</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-758131761">
										<pre class="prettyprint linenums">select    Title,
          extract(Year from ReleaseDate) as ReleaseYear
from      Movies</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-758131761">
										<pre class="prettyprint linenums">select    Title,
          Year(ReleaseDate) as ReleaseYear
from      Movies</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-758131761">
										<pre class="prettyprint linenums">select    Title,
          extract(Year from ReleaseDate) as ReleaseYear
from      Movies</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">

					<p>String concatenation (combining strings) is a common requirement when querying. This is how you
						combine multiple strings together for form a single string result.</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Example
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-1614114795" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-1614114795" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-1614114795" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-1614114795" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-1614114795">
										<pre
											class="prettyprint linenums">select    'FirstName' + ' ' + 'LastName' as complete_name</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-1614114795">
										<pre class="prettyprint linenums">select    'FirstName' || ' ' || 'LastName' as complete_name
from      dual</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-1614114795">
										<pre
											class="prettyprint linenums">select    concat('FirstName', ' ', 'LastName') as complete_name</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-1614114795">
										<pre
											class="prettyprint linenums">select    'FirstName' || ' ' || 'LastName' as complete_name</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">

					<p>The <strong>cast</strong> function can be used to convert one data type to another. This example
						converts the numeric Movie Id value to a string. Note that data types and precision are
						database-specific.</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Example
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-1514702892" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-1514702892" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-1514702892" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-1514702892" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-1514702892">
										<pre class="prettyprint linenums">select    (cast(MovieId as varchar))
from      movies</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-1514702892">
										<pre class="prettyprint linenums">select    (cast(MovieId as varchar(10)))
from      movies</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-1514702892">
										<pre class="prettyprint linenums">select    (cast(MovieId as char))
from      movies</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-1514702892">
										<pre class="prettyprint linenums">select    (cast(MovieId as varchar))
from      movies</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">

					<p>A <strong>simple case statement</strong> is where a column value is compared against a specified
						list.</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Example
						</div>
						<div class="panel-body">
							<div>


								<pre class="prettyprint linenums">select    name,
          case name
            when 'Actors' then 'On-set'
            when 'Art' then 'Off-set'
            when 'Camera' then 'On-set'
            when 'Costume & Make-Up' then 'On-set'
            when 'Crew' then 'On-set'
            when 'Directing' then 'On-set'
            when 'Editing' then 'On-set'
            when 'Lighting' then 'On-set'
            when 'Production' then 'On-set'
            when 'Sound' then 'Off-set'
            when 'Visual Effects' then 'Off-set'
            when 'Writing' then 'Off-set'
          end as location
from      departments</pre>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">

					<p>A <strong>searched case statement</strong> is where the first comparison that returns true will
						generate the result value.</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Example
						</div>
						<div class="panel-body">
							<div>


								<pre class="prettyprint linenums">select    title,
          case
            when runtime < 30 then 'Short'
            when runtime < 180 then 'Feature'
            else 'Series'
          end as length
from      movies</pre>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">

					<p>The <strong>coalesce</strong> function can be used to convert null values into a default value.
					</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Example
						</div>
						<div class="panel-body">
							<div>


								<pre class="prettyprint linenums">select    title,
          coalesce(budget, 0) as budget,
          coalesce(revenue, 0) as revenue
from      movies</pre>


							</div>
						</div>
					</div>

				</div>




				<h3>Exercises</h3>







				<div class="exercise bottom20">

					<ol>
						<li>Select the MovieId, and the MovieId + 1 from the Movies table.</li>
					</ol>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-604633360" aria-expanded="false"
						aria-controls="collapse-aria-controls-604633360">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-604633360">


						<pre class="prettyprint linenums">select    A.MovieId as MovieId,
          A.MovieId + 1
from      Movies A</pre>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="2">
						<li>Select one column that combines:</li>
					</ol>
					<ul>
						<li>The MovieId</li>
						<li>A dash character, surrounded by a space on either side</li>
						<li>The Title</li>
					</ul>
					<p>from the Movies table. Alias the column to be called MovieIdAndTitle.</p>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-1214293209" aria-expanded="false"
						aria-controls="collapse-aria-controls-1214293209">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-1214293209">


						<ul class="nav nav-tabs" role="tablist">
							<li role="presentation" class="active"><a href="#sql-server-1214293209" role="tab"
									data-toggle="tab">Microsoft SQL Server</a></li>
							<li role="presentation"><a href="#oracle-1214293209" role="tab" data-toggle="tab">Oracle</a>
							</li>
							<li role="presentation"><a href="#mysql-1214293209" role="tab" data-toggle="tab">MySQL</a>
							</li>
							<li role="presentation"><a href="#postgres-1214293209" role="tab"
									data-toggle="tab">Postgres</a></li>
						</ul>

						<div class="tab-content">
							<div role="tabpanel" class="tab-pane active" id="sql-server-1214293209">
								<pre class="prettyprint linenums">select    cast(A.MovieId as varchar) + ' - ' + A.Title as MovieIdAndTitle
from      Movies A</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="oracle-1214293209">
								<pre class="prettyprint linenums">select    Cast(A.MovieId as varchar(10)) || ' - ' || A.Title as MovieIdAndTitle
from      MOVIES A</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="mysql-1214293209">
								<pre class="prettyprint linenums">select    concat( cast ( A.MovieId as char(10) ), ' - ', a.Title) as MovieIdAndTitle
from      movies A</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="postgres-1214293209">
								<pre class="prettyprint linenums">select    Cast(A.MovieId as varchar(10)) || ' - ' || A.Title as MovieIdAndTitle
from      MOVIES A</pre>
							</div>
						</div>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="3">
						<li>Select the:</li>
					</ol>
					<ul>
						<li>Release Date</li>
						<li>Year of the Release Date</li>
					</ul>
					<p>from the Movies table.</p>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-2063978326" aria-expanded="false"
						aria-controls="collapse-aria-controls-2063978326">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-2063978326">


						<ul class="nav nav-tabs" role="tablist">
							<li role="presentation" class="active"><a href="#sql-server-2063978326" role="tab"
									data-toggle="tab">Microsoft SQL Server</a></li>
							<li role="presentation"><a href="#oracle-2063978326" role="tab" data-toggle="tab">Oracle</a>
							</li>
							<li role="presentation"><a href="#mysql-2063978326" role="tab" data-toggle="tab">MySQL</a>
							</li>
							<li role="presentation"><a href="#postgres-2063978326" role="tab"
									data-toggle="tab">Postgres</a></li>
						</ul>

						<div class="tab-content">
							<div role="tabpanel" class="tab-pane active" id="sql-server-2063978326">
								<pre class="prettyprint linenums">select    ReleaseDate,
          DatePart(Year, ReleaseDate) as ReleaseYear
from      Movies</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="oracle-2063978326">
								<pre class="prettyprint linenums">select    ReleaseDate,
          extract(Year from ReleaseDate) as ReleaseYear
from      Movies</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="mysql-2063978326">
								<pre class="prettyprint linenums">select    ReleaseDate,
          Year(ReleaseDate) as ReleaseYear
from      Movies</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="postgres-2063978326">
								<pre class="prettyprint linenums">select    ReleaseDate,
          extract(Year from ReleaseDate) as ReleaseYear
from      Movies</pre>
							</div>
						</div>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="4">
						<li>Select the:</li>
					</ol>
					<ul>
						<li>Title</li>
						<li>Year of release</li>
						<li>Budget (rounded to the nearest thousands)</li>
						<li>Revenue(rounded to the nearest thousands)</li>
					</ul>
					<p>from the Movies table.</p>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-62911209" aria-expanded="false"
						aria-controls="collapse-aria-controls-62911209">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-62911209">


						<ul class="nav nav-tabs" role="tablist">
							<li role="presentation" class="active"><a href="#sql-server-62911209" role="tab"
									data-toggle="tab">Microsoft SQL Server</a></li>
							<li role="presentation"><a href="#oracle-62911209" role="tab" data-toggle="tab">Oracle</a>
							</li>
							<li role="presentation"><a href="#mysql-62911209" role="tab" data-toggle="tab">MySQL</a>
							</li>
							<li role="presentation"><a href="#postgres-62911209" role="tab"
									data-toggle="tab">Postgres</a></li>
						</ul>

						<div class="tab-content">
							<div role="tabpanel" class="tab-pane active" id="sql-server-62911209">
								<pre class="prettyprint linenums">select    Title,
          DatePart(year, ReleaseDate) as ReleaseYear,
          round(budget, -3) as Budget,
          round(revenue, -3) as Revenue
from      movies</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="oracle-62911209">
								<pre class="prettyprint linenums">select    Title,
          extract(year from ReleaseDate) as ReleaseYear,
          round(budget, -3) as Budget,
          round(revenue, -3) as Revenue
from      movies</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="mysql-62911209">
								<pre class="prettyprint linenums">select    Title,
          Year(ReleaseDate) as ReleaseYear,
          round(budget, -3) as Budget,
          round(revenue, -3) as Revenue
from      movies</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="postgres-62911209">
								<pre class="prettyprint linenums">select    Title,
          extract(year from ReleaseDate) as ReleaseYear,
          round(cast(budget as numeric), -3) as Budget,
          round(cast(revenue as numeric), -3) as Revenue
from      movies</pre>
							</div>
						</div>


					</div>

				</div>





				<section id="where">
					<div class="page-header">
						<h1>Where</h1>
						<a href="javascript:;">To top <i class="icon-arrow-up"></i></a>
					</div>
				</section>


				<h3>Syntax Review</h3>





				<div class="syntax">

					<p>By default, a query returns all rows. You can use the <strong>where</strong> clause to restrict
						the rows returned.</p>
					<p>To limit <strong>numeric</strong> columns, you can use the following comparisons:</p>
					<ul>
						<li>=</li>
						<li>!=</li>
						<li>&lt;&gt;</li>
						<li>&gt;</li>
						<li>&gt;=</li>
						<li>&lt;</li>
						<li>&lt;=</li>
						<li>between</li>
						<li>not between</li>
						<li>in</li>
						<li>not in</li>
					</ul>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Numeric Comparison Example
						</div>
						<div class="panel-body">
							<div>


								<pre class="prettyprint linenums">select    *
from      Movies
where     MovieId = 808</pre>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">




					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Between Example
						</div>
						<div class="panel-body">
							<div>


								<pre class="prettyprint linenums">select    *
from      Movies
where     MovieId between 100 and 200</pre>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">




					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Numeric In List Example
						</div>
						<div class="panel-body">
							<div>


								<pre class="prettyprint linenums">select    *
from      Movies
where     MovieId in (153, 155, 161, 163)</pre>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">

					<p>To filter <strong>text</strong> columns, you can use the following comparisons:</p>
					<ul>
						<li>=</li>
						<li>!=</li>
						<li>&lt;&gt;</li>
						<li>&gt;</li>
						<li>&gt;=</li>
						<li>&lt;</li>
						<li>&lt;=</li>
						<li>between</li>
						<li>like</li>
						<li>in</li>
					</ul>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							String Comparison Example
						</div>
						<div class="panel-body">
							<div>


								<pre class="prettyprint linenums">select    *
from      Movies
where     Title = 'Shrek'</pre>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">




					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							String Between Example
						</div>
						<div class="panel-body">
							<div>


								<pre class="prettyprint linenums">select    *
from      Movies
where     Title between 'A' and 'C'</pre>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">

					<p>Use the % sign as a wildcard search when doing <strong>like</strong> comparisons.</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							String Wildcard Search Example
						</div>
						<div class="panel-body">
							<div>


								<pre class="prettyprint linenums">select    *
from      Movies
where     Title like '%the%'</pre>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">

					<p>To filter <strong>date</strong> and <strong>date/time</strong> columns, you can use the following
						comparisons:</p>
					<ul>
						<li>=</li>
						<li>!=</li>
						<li>&lt;&gt;</li>
						<li>&gt;</li>
						<li>&gt;=</li>
						<li>&lt;</li>
						<li>&lt;=</li>
						<li>between</li>
						<li>in</li>
					</ul>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Date Comparison Example
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-222434431" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-222434431" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-222434431" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-222434431" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-222434431">
										<pre class="prettyprint linenums">select    *
from      Movies
where     ReleaseDate >= '2010-01-01'</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-222434431">
										<pre class="prettyprint linenums">select    *
from      Movies
where     ReleaseDate >= to_date('2010-01-01', 'yyyy-mm-dd')</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-222434431">
										<pre class="prettyprint linenums">select    *
from      Movies
where     ReleaseDate >= '2010-01-01'</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-222434431">
										<pre class="prettyprint linenums">select    *
from      Movies
where     ReleaseDate >= to_date('2010-01-01', 'yyyy-mm-dd')</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">




					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Date Between Example
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-2021671256" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-2021671256" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-2021671256" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-2021671256" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-2021671256">
										<pre class="prettyprint linenums">select    *
from      Movies
where     ReleaseDate between '2010-01-01' and '2011-01-01'</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-2021671256">
										<pre class="prettyprint linenums">select    *
from      Movies
where     ReleaseDate between to_date('2010-01-01', 'yyyy-mm-dd') and to_date('2011-01-01', 'yyyy-mm-dd')</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-2021671256">
										<pre class="prettyprint linenums">select    *
from      Movies
where     ReleaseDate between '2010-01-01' and '2011-01-01'</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-2021671256">
										<pre class="prettyprint linenums">select    *
from      Movies
where     ReleaseDate between to_date('2010-01-01', 'yyyy-mm-dd') and to_date('2011-01-01', 'yyyy-mm-dd')</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">

					<p>Multiple filter conditions can be combined using various combinations of:</p>
					<ul>
						<li>And</li>
						<li>Or</li>
						<li>Not</li>
						<li>Parenthesis</li>
					</ul>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Combining Multiple Filter Conditions
						</div>
						<div class="panel-body">
							<div>


								<pre class="prettyprint linenums">select    *
from      Movies
where     Title like '%the%'
and       VoteAverage >= 7.5</pre>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">




					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Negating Multiple Optional Conditions
						</div>
						<div class="panel-body">
							<div>


								<pre class="prettyprint linenums">select    *
from      Movies
where     not (Title like '%the%' or VoteAverage >= 7.5)</pre>


							</div>
						</div>
					</div>

				</div>




				<h3>Exercises</h3>







				<div class="exercise bottom20">

					<ol>
						<li>Select the MovieId, Title and ReleaseDate columns from the Movies table where the MovieId
							value is 808.</li>
					</ol>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-922992913" aria-expanded="false"
						aria-controls="collapse-aria-controls-922992913">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-922992913">


						<pre class="prettyprint linenums">select    A.MovieId as MovieId,
          A.Title as Title,
          A.ReleaseDate as ReleaseDate
from      Movies A
where     A.MovieId = 808</pre>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="2">
						<li>Select the MovieId, Title and ReleaseDate columns from the Movies table where the MovieId
							value is between 500 and 600.</li>
					</ol>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-1049020485" aria-expanded="false"
						aria-controls="collapse-aria-controls-1049020485">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-1049020485">


						<pre class="prettyprint linenums">select    A.MovieId as MovieId,
          A.Title as Title,
          A.ReleaseDate as ReleaseDate
from      Movies A
where     A.MovieId between 500 and 600</pre>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="3">
						<li>Select the MovieId, Title and ReleaseDate columns from the Movies table for the movie
							&quot;Shrek&quot;.</li>
					</ol>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-683482154" aria-expanded="false"
						aria-controls="collapse-aria-controls-683482154">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-683482154">


						<pre class="prettyprint linenums">select    A.MovieId as MovieId,
          A.Title as Title,
          A.ReleaseDate as ReleaseDate
from      Movies A
where     A.Title = 'Shrek'</pre>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="4">
						<li>Select the MovieId, Title and ReleaseDate columns for all movies that start with the letter
							R.</li>
					</ol>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-369385533" aria-expanded="false"
						aria-controls="collapse-aria-controls-369385533">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-369385533">


						<pre class="prettyprint linenums">select    A.MovieId as MovieId,
          A.Title as Title,
          A.ReleaseDate as ReleaseDate
from      Movies A
where     A.Title like 'R%'</pre>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="5">
						<li>Select the MovieId, Title and ReleaseDate columns for all movies that:</li>
					</ol>
					<ul>
						<li>Does not start with the word &quot;The&quot;</li>
						<li>Does not end with the word &quot;The&quot;</li>
						<li>Does not contain the word &quot;The&quot;</li>
					</ul>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-183661858" aria-expanded="false"
						aria-controls="collapse-aria-controls-183661858">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-183661858">


						<pre class="prettyprint linenums">select    A.MovieId as MovieId,
          A.Title as Title,
          A.ReleaseDate as ReleaseDate
from      Movies A
where     A.Title not like '%The%'
And       A.Title not like 'The%'
And       A.Title not like '%The'</pre>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="6">
						<li></li>
					</ol>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-198968820" aria-expanded="false"
						aria-controls="collapse-aria-controls-198968820">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-198968820">


						<pre class="prettyprint linenums">select    A.MovieId as MovieId,
          A.Title as Title,
          A.ReleaseDate as ReleaseDate
from      Movies A
where     not ((A.Title not like '%The%' Or A.Title not like 'The%' Or A.Title not like '%The'))</pre>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="7">
						<li>Select the MovieId, Title and ReleaseDate columns from the Movies table where the release
							date is between:</li>
					</ol>
					<ul>
						<li>January 1, 2012</li>
						<li>January 1, 2014</li>
					</ul>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-44998591" aria-expanded="false"
						aria-controls="collapse-aria-controls-44998591">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-44998591">


						<ul class="nav nav-tabs" role="tablist">
							<li role="presentation" class="active"><a href="#sql-server-44998591" role="tab"
									data-toggle="tab">Microsoft SQL Server</a></li>
							<li role="presentation"><a href="#oracle-44998591" role="tab" data-toggle="tab">Oracle</a>
							</li>
							<li role="presentation"><a href="#mysql-44998591" role="tab" data-toggle="tab">MySQL</a>
							</li>
							<li role="presentation"><a href="#postgres-44998591" role="tab"
									data-toggle="tab">Postgres</a></li>
						</ul>

						<div class="tab-content">
							<div role="tabpanel" class="tab-pane active" id="sql-server-44998591">
								<pre class="prettyprint linenums">select    A.MovieId as MovieId,
          A.Title as Title,
          A.ReleaseDate as ReleaseDate
from      Movies A
where     A.ReleaseDate between '2012-01-01' and '2014-01-01'</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="oracle-44998591">
								<pre class="prettyprint linenums">select    A.MovieId as MovieId,
          A.Title as Title,
          A.ReleaseDate as ReleaseDate
from      Movies A
where     A.ReleaseDate between to_date('2012-01-01', 'yyyy-mm-dd') and to_date('2012-01-01', 'yyyy-mm-dd')</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="mysql-44998591">
								<pre class="prettyprint linenums">select    A.MovieId as MovieId,
          A.Title as Title,
          A.ReleaseDate as ReleaseDate
from      Movies A
where     A.ReleaseDate between '2012-01-01' and '2014-01-01'</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="postgres-44998591">
								<pre class="prettyprint linenums">select    A.MovieId as MovieId,
          A.Title as Title,
          A.ReleaseDate as ReleaseDate
from      Movies A
where     A.ReleaseDate between to_date('2014-01-01', 'YYYY-MM-DD') and to_date('2014-01-01', 'YYYY-MM-DD')</pre>
							</div>
						</div>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="8">
						<li>Select the ActorId, Name and Born columns from the Actors table for all actors born after
							January 1, 1990.</li>
					</ol>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-1737675747" aria-expanded="false"
						aria-controls="collapse-aria-controls-1737675747">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-1737675747">


						<ul class="nav nav-tabs" role="tablist">
							<li role="presentation" class="active"><a href="#sql-server-1737675747" role="tab"
									data-toggle="tab">Microsoft SQL Server</a></li>
							<li role="presentation"><a href="#oracle-1737675747" role="tab" data-toggle="tab">Oracle</a>
							</li>
							<li role="presentation"><a href="#mysql-1737675747" role="tab" data-toggle="tab">MySQL</a>
							</li>
							<li role="presentation"><a href="#postgres-1737675747" role="tab"
									data-toggle="tab">Postgres</a></li>
						</ul>

						<div class="tab-content">
							<div role="tabpanel" class="tab-pane active" id="sql-server-1737675747">
								<pre class="prettyprint linenums">select    A.Born as Born,
          A.Name as Name,
          A.ActorId as ActorId
from      Actors A
where     A.Born > '1990-01-01'</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="oracle-1737675747">
								<pre class="prettyprint linenums">select    A.Born as Born,
          A.Name as Name,
          A.ActorId as ActorId
from      Actors A
where     A.Born > to_date('1990-01-01', 'yyyy-mm-dd')</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="mysql-1737675747">
								<pre class="prettyprint linenums">select    A.Born as Born,
          A.Name as Name,
          A.ActorId as ActorId
from      Actors A
where     A.Born > '1990-01-01'</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="postgres-1737675747">
								<pre class="prettyprint linenums">select    A.Born as Born,
          A.Name as Name,
          A.ActorId as ActorId
from      Actors A
where     A.Born > to_date('1990-01-01', 'YYYY-MM-DD')</pre>
							</div>
						</div>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="9">
						<li>Select the Movie ID, Title and Revenue columns for all movies where the budget is null but
							the revenue is not null.</li>
					</ol>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-46159905" aria-expanded="false"
						aria-controls="collapse-aria-controls-46159905">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-46159905">


						<pre class="prettyprint linenums">select    A.MovieId as MovieId,
          A.Title as Title,
          A.Revenue as Revenue
from      Movies A
where     A.Budget is null
And       A.Revenue is not null</pre>


					</div>

				</div>





				<section id="joins">
					<div class="page-header">
						<h1>Joins</h1>
						<a href="javascript:;">To top <i class="icon-arrow-up"></i></a>
					</div>
				</section>


				<h3>Syntax Review</h3>





				<div class="syntax">

					<p>Multiple tables can be joined together to create virtual rows. The types of joins available are:
					</p>
					<ul>
						<li>Inner (Equal) Joins - matching rows between both tables will be returned</li>
						<li>Left Outer Join - all rows from the left table and matching rows from the right table will
							be returned</li>
						<li>Right Outer Join - all rows from the right table and matching rows from the left table will
							be returned</li>
						<li>Full Outer Join - all rows from both tables will be returned, matched if possible</li>
						<li>Cross Join - all rows from both tables will be returned, joined on no conditions
							<ul>
								<li>This is also known as a cartesian product, and is generally considered a severe
									problem due to the performance impact it has on the database</li>
							</ul>
						</li>
					</ul>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Inner Join Example
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-1731290416" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-1731290416" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-1731290416" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-1731290416" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-1731290416">
										<pre class="prettyprint linenums">select    A.Title as Title,
          A.ReleaseDate as ReleaseDate,
          C.Name as Actor,
          B.[Character] as [Character]
from      ((Movies A
            Join [Cast] B on (A.MovieId = B.MovieId))
           Join Actors C on (B.CastId = C.ActorId))</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-1731290416">
										<pre class="prettyprint linenums">select    A.Title as Title,
          A.ReleaseDate as ReleaseDate,
          C.Name as Actor,
          B.Character as Character
from      ((Movies A
            Join Cast B on (A.MovieId = B.MovieId))
           Join Actors C on (B.CastId = C.ActorId))</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-1731290416">
										<pre class="prettyprint linenums">select    A.Title as Title,
          A.ReleaseDate as ReleaseDate,
          C.Name as Actor,
          B.`Character` as `Character`
from      ((Movies A
            Join `Cast` B on (A.MovieId = B.MovieId))
           Join Actors C on (B.CastId = C.ActorId))</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-1731290416">
										<pre class="prettyprint linenums">select    A.Title as Title,
          A.ReleaseDate as ReleaseDate,
          C.Name as Actor,
          B.Character as Character
from      ((Movies A
            Join "Cast" B on (A.MovieId = B.MovieId))
           Join Actors C on (B.CastId = C.ActorId))</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">




					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Left Outer Join Example
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-899303948" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-899303948" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-899303948" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-899303948" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-899303948">
										<pre class="prettyprint linenums">select    A.Title as Title,
          A.ReleaseDate as ReleaseDate,
          C.Name as Actor,
          B.[Character] as [Character]
from      ((Movies A
            Left Outer Join [Cast] B on (A.MovieId = B.MovieId))
           Left Outer Join Actors C on (B.CastId = C.ActorId))</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-899303948">
										<pre class="prettyprint linenums">select    A.Title as Title,
          A.ReleaseDate as ReleaseDate,
          C.Name as Actor,
          B.Character as Character
from      ((Movies A
            Left Outer Join Cast B on (A.MovieId = B.MovieId))
           Left Outer Join Actors C on (B.CastId = C.ActorId))</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-899303948">
										<pre class="prettyprint linenums">select    A.Title as Title,
          A.ReleaseDate as ReleaseDate,
          C.Name as Actor,
          B.`Character` as `Character`
from      ((Movies A
            Left Outer Join `Cast` B on (A.MovieId = B.MovieId))
           Left Outer Join Actors C on (B.CastId = C.ActorId))</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-899303948">
										<pre class="prettyprint linenums">select    A.Title as Title,
          A.ReleaseDate as ReleaseDate,
          C.Name as Actor,
          B.Character as Character
from      ((Movies A
            Left Outer Join "Cast" B on (A.MovieId = B.MovieId))
           Left Outer Join Actors C on (B.CastId = C.ActorId))</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">




					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Right Outer Join Example
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-1194117729" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-1194117729" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-1194117729" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-1194117729" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-1194117729">
										<pre class="prettyprint linenums">select    A.Title as Title,
          A.ReleaseDate as ReleaseDate,
          C.Name as Actor,
          B.[Character] as [Character]
from      ((Movies A
            Right Outer Join [Cast] B on (A.MovieId = B.MovieId))
           Right Outer Join Actors C on (B.CastId = C.ActorId))</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-1194117729">
										<pre class="prettyprint linenums">select    A.Title as Title,
          A.ReleaseDate as ReleaseDate,
          C.Name as Actor,
          B.Character as Character
from      ((Movies A
            Right Outer Join Cast B on (A.MovieId = B.MovieId))
           Right Outer Join Actors C on (B.CastId = C.ActorId))</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-1194117729">
										<pre class="prettyprint linenums">select    A.Title as Title,
          A.ReleaseDate as ReleaseDate,
          C.Name as Actor,
          B.`Character` as `Character`
from      ((Movies A
            Right Outer Join `Cast` B on (A.MovieId = B.MovieId))
           Right Outer Join Actors C on (B.CastId = C.ActorId))</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-1194117729">
										<pre class="prettyprint linenums">select    A.Title as Title,
          A.ReleaseDate as ReleaseDate,
          C.Name as Actor,
          B.Character as Character
from      ((Movies A
            Right Outer Join "Cast" B on (A.MovieId = B.MovieId))
           Right Outer Join Actors C on (B.CastId = C.ActorId))</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">

					<p><strong>Simplified Equal Join Syntax</strong></p>
					<p>Equal joins can be written using a syntax that puts the join conditions in the
						<strong>where</strong> clause.
					</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Simplified Join Syntax Example
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-1342225658" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-1342225658" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-1342225658" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-1342225658" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-1342225658">
										<pre class="prettyprint linenums">select    A.Title as Title,
          A.ReleaseDate as ReleaseDate,
          C.Name as Actor,
          B.[Character] as [Character]
from      Movies A,
          [Cast] B,
          Actors C
where     A.MovieId = B.MovieId
and       B.CastId = C.ActorId</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-1342225658">
										<pre class="prettyprint linenums">select    A.Title as Title,
          A.ReleaseDate as ReleaseDate,
          C.Name as Actor,
          B.Character as Character
from      Movies A,
          Cast B,
          Actors C
where     A.MovieId = B.MovieId
and       B.CastId = C.ActorId</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-1342225658">
										<pre class="prettyprint linenums">select    A.Title as Title,
          A.ReleaseDate as ReleaseDate,
          C.Name as Actor,
          B.`Character` as `Character`
from      Movies A,
          `Cast` B,
          Actors C
where     A.MovieId = B.MovieId
and       B.CastId = C.ActorId</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-1342225658">
										<pre class="prettyprint linenums">select    A.Title as Title,
          A.ReleaseDate as ReleaseDate,
          C.Name as Actor,
          B.Character as Character
from      Movies A,
          "Cast" B,
          Actors C
where     A.MovieId = B.MovieId
and       B.CastId = C.ActorId</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>




				<h3>Exercises</h3>







				<div class="exercise bottom20">

					<ol>
						<li>Select the:</li>
					</ol>
					<ul>
						<li>Actor Name</li>
						<li>Movie Title</li>
						<li>Character</li>
					</ul>
					<p>from the:</p>
					<ul>
						<li>Actors</li>
						<li>Cast</li>
						<li>Movies</li>
					</ul>
					<p>tables where the actor name is any of:</p>
					<ul>
						<li>Maggie Smith</li>
						<li><span></span>Helena Bonham Carter</li>
						<li><span></span>Emma Thompson</li>
					</ul>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-81140423" aria-expanded="false"
						aria-controls="collapse-aria-controls-81140423">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-81140423">


						<ul class="nav nav-tabs" role="tablist">
							<li role="presentation" class="active"><a href="#sql-server-81140423" role="tab"
									data-toggle="tab">Microsoft SQL Server</a></li>
							<li role="presentation"><a href="#oracle-81140423" role="tab" data-toggle="tab">Oracle</a>
							</li>
							<li role="presentation"><a href="#mysql-81140423" role="tab" data-toggle="tab">MySQL</a>
							</li>
							<li role="presentation"><a href="#postgres-81140423" role="tab"
									data-toggle="tab">Postgres</a></li>
						</ul>

						<div class="tab-content">
							<div role="tabpanel" class="tab-pane active" id="sql-server-81140423">
								<pre class="prettyprint linenums">select    C.Name as Name,
          A.Title as Title,
          B.[Character] as [Character]
from      ((Movies A
            Join [Cast] B on (A.MovieId = B.MovieId))
           Join Actors C on (B.ActorId = C.ActorId))
where     C.Name in ('Maggie Smith', 'Helena Bonham Carter', 'Emma Thompson')</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="oracle-81140423">
								<pre class="prettyprint linenums">select    C.Name as Name,
          A.Title as Title,
          B.Character as Character
from      ((Movies A
            Join Cast B on (A.MovieId = B.MovieId))
           Join Actors C on (B.ActorId = C.ActorId))
where     C.Name in ('Maggie Smith',
                     'Helena Bonham Carter',
                     'Emma Thompson')</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="mysql-81140423">
								<pre class="prettyprint linenums">select    A.Title as Title,
          B.`Character` as `Character`,
          C.Name as Name
from      ((movies A
            Join `cast` B on (A.MovieId = B.MovieId))
           Join actors C on (B.ActorId = C.ActorId))
where     C.Name in ('Maggie Smith', 'Helena Bonham Carter', 'Emma Thompson')</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="postgres-81140423">
								<pre class="prettyprint linenums">select    C.Name as Name,
          A.Title as Title,
          B.Character as Character
from      ((Movies A
            Join "Cast" B on (A.MovieId = B.MovieId))
           Join Actors C on (B.ActorId = C.ActorId))
where     C.Name in ('Maggie Smith', 'Helena Bonham Carter', 'Emma Thompson')</pre>
							</div>
						</div>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="2">
						<li>Select the:</li>
					</ol>
					<ul>
						<li>Title</li>
						<li>Vote Average</li>
						<li>Vote Count</li>
					</ul>
					<p>from the Movies table for movies that were filmed in:</p>
					<ul>
						<li>Canada</li>
						<li>Australia</li>
					</ul>
					<p>and released in the year:</p>
					<ul>
						<li>2005</li>
						<li>2007</li>
						<li>2009</li>
					</ul>
					<p>This exercise demonstrates both the simplified and ANSI join syntax.</p>
					<p>Write the joins in the <strong>From</strong> clause.</p>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-902947003" aria-expanded="false"
						aria-controls="collapse-aria-controls-902947003">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-902947003">


						<ul class="nav nav-tabs" role="tablist">
							<li role="presentation" class="active"><a href="#sql-server-902947003" role="tab"
									data-toggle="tab">Microsoft SQL Server</a></li>
							<li role="presentation"><a href="#oracle-902947003" role="tab" data-toggle="tab">Oracle</a>
							</li>
							<li role="presentation"><a href="#mysql-902947003" role="tab" data-toggle="tab">MySQL</a>
							</li>
							<li role="presentation"><a href="#postgres-902947003" role="tab"
									data-toggle="tab">Postgres</a></li>
						</ul>

						<div class="tab-content">
							<div role="tabpanel" class="tab-pane active" id="sql-server-902947003">
								<pre class="prettyprint linenums">select    A.Title as Title,
          A.VoteAverage as VoteAverage,
          A.VoteCount as VoteCount
from      ((Movies A
            Join Locations B on (A.MovieId = B.MovieId))
           Join Countries C on (B.CountryId = C.CountryId))
where     C.Name in ('Canada', 'Australia')
And       datepart(year, A.ReleaseDate) in (2005, 2007, 2009)</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="oracle-902947003">
								<pre class="prettyprint linenums">select    A.Title as Title,
          A.VoteAverage as VoteAverage,
          A.VoteCount as VoteCount
from      ((Movies A
            Join Locations B on (A.MovieId = B.MovieId))
           Join Countries C on (B.CountryId = C.CountryId))
where     C.Name in ('Canada', 'Australia')
And       extract(year from A.ReleaseDate) in (2005, 2007, 2009)</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="mysql-902947003">
								<pre class="prettyprint linenums">select    A.Title as Title,
          A.VoteAverage as VoteAverage,
          A.VoteCount as VoteCount
from      ((Movies A
            Join Locations B on (A.MovieId = B.MovieId))
           Join Countries C on (B.CountryId = C.CountryId))
where     C.Name in ('Canada', 'Australia')
And       year(A.ReleaseDate) in (2005, 2007, 2009)</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="postgres-902947003">
								<pre class="prettyprint linenums">select    A.Title as Title,
          A.VoteAverage as VoteAverage,
          A.VoteCount as VoteCount
from      ((Movies A
            Join Locations B on (A.MovieId = B.MovieId))
           Join Countries C on (B.CountryId = C.CountryId))
where     C.Name in ('Canada', 'Australia')
And       extract(year from A.ReleaseDate) in (2005, 2007, 2009)</pre>
							</div>
						</div>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="3">
						<li>Write the joins in the <strong>Where</strong> clause.</li>
					</ol>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-953642041" aria-expanded="false"
						aria-controls="collapse-aria-controls-953642041">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-953642041">


						<ul class="nav nav-tabs" role="tablist">
							<li role="presentation" class="active"><a href="#sql-server-953642041" role="tab"
									data-toggle="tab">Microsoft SQL Server</a></li>
							<li role="presentation"><a href="#oracle-953642041" role="tab" data-toggle="tab">Oracle</a>
							</li>
							<li role="presentation"><a href="#mysql-953642041" role="tab" data-toggle="tab">MySQL</a>
							</li>
							<li role="presentation"><a href="#postgres-953642041" role="tab"
									data-toggle="tab">Postgres</a></li>
						</ul>

						<div class="tab-content">
							<div role="tabpanel" class="tab-pane active" id="sql-server-953642041">
								<pre class="prettyprint linenums">select    A.Title as Title,
          A.VoteAverage as VoteAverage,
          A.VoteCount as VoteCount
from      Movies A,
          Locations B,
          Countries C
where     A.MovieId = B.MovieId
and       B.CountryId = C.CountryId
And       C.Name in ('Canada', 'Australia')
And       datepart(year, A.ReleaseDate) in (2005, 2007, 2009)</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="oracle-953642041">
								<pre class="prettyprint linenums">select    A.Title as Title,
          A.VoteAverage as VoteAverage,
          A.VoteCount as VoteCount
from      Movies A,
          Locations B,
          Countries C
where     A.MovieId = B.MovieId
and       B.CountryId = C.CountryId
And       C.Name in ('Canada', 'Australia')
And       extract(year from A.ReleaseDate) in (2005, 2007, 2009)</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="mysql-953642041">
								<pre class="prettyprint linenums">select    A.Title as Title,
          A.VoteAverage as VoteAverage,
          A.VoteCount as VoteCount
from      Movies A,
          Locations B,
          Countries C
where     A.MovieId = B.MovieId
and       B.CountryId = C.CountryId
And       C.Name in ('Canada', 'Australia')
And       Year(A.ReleaseDate) in (2005, 2007, 2009)</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="postgres-953642041">
								<pre class="prettyprint linenums">select    A.Title as Title,
          A.VoteAverage as VoteAverage,
          A.VoteCount as VoteCount
from      Movies A,
          Locations B,
          Countries C
where     A.MovieId = B.MovieId
and       B.CountryId = C.CountryId
And       C.Name in ('Canada', 'Australia')
And       extract(year from A.ReleaseDate) in (2005, 2007, 2009)</pre>
							</div>
						</div>


					</div>

				</div>





				<section id="group-by">
					<div class="page-header">
						<h1>Group By</h1>
						<a href="javascript:;">To top <i class="icon-arrow-up"></i></a>
					</div>
				</section>


				<h3>Syntax Review</h3>





				<div class="syntax">

					<p>Detail rows can be aggregated into summary rows using the <em>group by</em> clause. Columns
						included in the select clause must either be:</p>
					<ul>
						<li>Grouped in the group by clause</li>
						<li>Have summary functions applied in the select clause
							<ul>
								<li>Sum</li>
								<li>Min</li>
								<li>Max</li>
								<li>Avg</li>
								<li>Count</li>
								<li>Var</li>
								<li>StdDev</li>
							</ul>
						</li>
					</ul>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Summarize Budget And Revenue By Year
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-1586577988" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-1586577988" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-1586577988" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-1586577988" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-1586577988">
										<pre class="prettyprint linenums">select    DatePart(Year, ReleaseDate) as ReleaseYear,
          Sum(Budget) as Budget,
          Sum(Revenue) as Revenue,
          Count(*) as MovieCount
from      Movies
group by  DatePart(Year, ReleaseDate)</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-1586577988">
										<pre class="prettyprint linenums">select    extract(Year from ReleaseDate) as ReleaseYear,
          Sum(Budget) as Budget,
          Sum(Revenue) as Revenue,
          Count(*) as MovieCount
from      Movies
group by  extract(Year from ReleaseDate)</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-1586577988">
										<pre class="prettyprint linenums">select    Year(ReleaseDate) as ReleaseYear,
          Sum(Budget) as Budget,
          Sum(Revenue) as Revenue,
          Count(*) as MovieCount
from      Movies
group by  Year(ReleaseDate)</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-1586577988">
										<pre class="prettyprint linenums">select    extract(Year from ReleaseDate) as ReleaseYear,
          Sum(Budget) as Budget,
          Sum(Revenue) as Revenue,
          Count(*) as MovieCount
from      Movies
group by  extract(Year from ReleaseDate)</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">

					<p>Separate the group by columns with commas to summarize on multiple fields.</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Summarize Budget And Revenue By Year And Genre
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-1457454901" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-1457454901" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-1457454901" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-1457454901" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-1457454901">
										<pre class="prettyprint linenums">select    C.Name as Genre,
          DatePart(Year, A.ReleaseDate) as ReleaseYear,
          Sum(A.Revenue) as Revenue,
          Sum(A.Budget) as Budget
from      ((Movies A
            Join Categories B on (A.MovieId = B.MovieId))
           Join Genres C on (B.GenreId = C.GenreId))
group by  DatePart(Year, A.ReleaseDate),
          C.Name</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-1457454901">
										<pre class="prettyprint linenums">select    C.Name as Genre,
          extract(Year from A.ReleaseDate) as ReleaseYear,
          Sum(A.Revenue) as Revenue,
          Sum(A.Budget) as Budget
from      ((Movies A
            Join Categories B on (A.MovieId = B.MovieId))
           Join Genres C on (B.GenreId = C.GenreId))
group by  extract(Year from A.ReleaseDate),
          C.Name</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-1457454901">
										<pre class="prettyprint linenums">select    C.Name as Genre,
          Year(A.ReleaseDate) as ReleaseYear,
          Sum(A.Revenue) as Revenue,
          Sum(A.Budget) as Budget
from      ((Movies A
            Join Categories B on (A.MovieId = B.MovieId))
           Join Genres C on (B.GenreId = C.GenreId))
group by  Year(A.ReleaseDate),
          C.Name</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-1457454901">
										<pre class="prettyprint linenums">select    C.Name as Genre,
          extract(Year from A.ReleaseDate) as ReleaseYear,
          Sum(A.Revenue) as Revenue,
          Sum(A.Budget) as Budget
from      ((Movies A
            Join Categories B on (A.MovieId = B.MovieId))
           Join Genres C on (B.GenreId = C.GenreId))
group by  extract(Year from A.ReleaseDate),
          C.Name</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>




				<h3>Exercises</h3>







				<div class="exercise bottom20">

					<ol>
						<li>Select the job title and the count of the number of people who had that job for the movie
							Avatar.</li>
					</ol>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-1522622871" aria-expanded="false"
						aria-controls="collapse-aria-controls-1522622871">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-1522622871">


						<pre class="prettyprint linenums">select    C.Title as Title,
          Count(*)
from      ((Movies A
            Join Crew B on (A.MovieId = B.MovieId))
           Join Jobs C on (B.JobId = C.JobId))
where     A.Title = 'Avatar'
group by  C.Title</pre>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="2">
						<li>Which movie studios (companies) have collaborated on Steven Spielberg directed films, and
							how many times has each one done so?</li>
					</ol>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-450819960" aria-expanded="false"
						aria-controls="collapse-aria-controls-450819960">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-450819960">


						<pre class="prettyprint linenums">select    E.Name as Name,
          Count(*)
from      ((((Creatives A
              Join Crew B on (A.CreativeId = B.CreativeId))
             Join Movies C on (B.MovieId = C.MovieId))
            Join Backers D on (D.MovieId = C.MovieId))
           Join Companies E on (E.CompanyId = D.CompanyId))
where     A.Name = 'Steven Spielberg'
group by  E.Name</pre>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="3">
						<li>For the genres of drama and comedy between 2011 and 2014, retrieve the:</li>
					</ol>
					<ul>
						<li>Genre</li>
						<li>Release year</li>
						<li>Sum of revenue</li>
						<li>Minimum of revenue</li>
						<li>Maximum of revenue</li>
						<li>Average of revenue</li>
					</ul>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-646849876" aria-expanded="false"
						aria-controls="collapse-aria-controls-646849876">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-646849876">


						<ul class="nav nav-tabs" role="tablist">
							<li role="presentation" class="active"><a href="#sql-server-646849876" role="tab"
									data-toggle="tab">Microsoft SQL Server</a></li>
							<li role="presentation"><a href="#oracle-646849876" role="tab" data-toggle="tab">Oracle</a>
							</li>
							<li role="presentation"><a href="#mysql-646849876" role="tab" data-toggle="tab">MySQL</a>
							</li>
							<li role="presentation"><a href="#postgres-646849876" role="tab"
									data-toggle="tab">Postgres</a></li>
						</ul>

						<div class="tab-content">
							<div role="tabpanel" class="tab-pane active" id="sql-server-646849876">
								<pre class="prettyprint linenums">select    C.Name as Name,
          DatePart(Year, A.ReleaseDate) as ReleaseYear,
          Sum(A.Revenue) as SumRevenue,
          Min(A.Revenue) as MinRevenue,
          Max(A.Revenue) as MaxRevenue,
          Avg(A.Revenue) as AvgRevenue
from      ((Movies A
            Join Categories B on (A.MovieId = B.MovieId))
           Join Genres C on (B.GenreId = C.GenreId))
where     DatePart(Year, A.ReleaseDate) between 2011 and 2014
And       C.Name in ('Drama', 'Comedy')
group by  DatePart(Year, A.ReleaseDate),
          C.Name</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="oracle-646849876">
								<pre class="prettyprint linenums">select    C.Name as Name,
          extract(Year from A.ReleaseDate) as ReleaseYear,
          Sum(A.Revenue) as SumRevenue,
          Min(A.Revenue) as MinRevenue,
          Max(A.Revenue) as MaxRevenue,
          Avg(A.Revenue) as AvgRevenue
from      ((Movies A
            Join Categories B on (A.MovieId = B.MovieId))
           Join Genres C on (B.GenreId = C.GenreId))
where     extract(Year from A.ReleaseDate) between 2011 and 2014
And       C.Name in ('Drama', 'Comedy')
group by  extract(Year from A.ReleaseDate),
          C.Name</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="mysql-646849876">
								<pre class="prettyprint linenums">select    C.Name as Name,
          Year(A.ReleaseDate) as ReleaseYear,
          Sum(A.Revenue) as SumRevenue,
          Min(A.Revenue) as MinRevenue,
          Max(A.Revenue) as MaxRevenue,
          Avg(A.Revenue) as AvgRevenue
from      ((Movies A
            Join Categories B on (A.MovieId = B.MovieId))
           Join Genres C on (B.GenreId = C.GenreId))
where     Year(A.ReleaseDate) between 2011 and 2014
And       C.Name in ('Drama', 'Comedy')
group by  Year(A.ReleaseDate),
          C.Name</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="postgres-646849876">
								<pre class="prettyprint linenums">select    C.Name as Name,
          extract(Year from A.ReleaseDate) as ReleaseYear,
          Sum(A.Revenue) as SumRevenue,
          Min(A.Revenue) as MinRevenue,
          Max(A.Revenue) as MaxRevenue,
          Avg(A.Revenue) as AvgRevenue
from      ((Movies A
            Join Categories B on (A.MovieId = B.MovieId))
           Join Genres C on (B.GenreId = C.GenreId))
where     extract(Year from A.ReleaseDate) between 2011 and 2014
And       C.Name in ('Drama', 'Comedy')
group by  extract(Year from A.ReleaseDate),
          C.Name</pre>
							</div>
						</div>


					</div>

				</div>





				<section id="having">
					<div class="page-header">
						<h1>Having</h1>
						<a href="javascript:;">To top <i class="icon-arrow-up"></i></a>
					</div>
				</section>


				<h3>Syntax Review</h3>





				<div class="syntax">

					<p>The <strong>having</strong> clause allow for filtering summarized rows in the same way the
						<strong>where</strong> clause allow filtering detail rows.
					</p>
					<p>All the same filter conditions apply to result column data types in the same manner as the
						<strong>where</strong> clause.
					</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Show all genres by year having total revenues greater than 100000000 and total budget
							between 10000000 and 50000000
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-877457132" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-877457132" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-877457132" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-877457132" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-877457132">
										<pre class="prettyprint linenums">select    C.Name as Genre,
          DatePart(Year, A.ReleaseDate) as ReleaseYear,
          Sum(A.Revenue) as Revenue,
          Sum(A.Budget) as Budget
from      ((Movies A
            Join Categories B on (A.MovieId = B.MovieId))
           Join Genres C on (B.GenreId = C.GenreId))
group by  DatePart(Year, A.ReleaseDate),
          C.Name
having    sum(revenue) >= 100000000
and       sum(budget) between 10000000 and 50000000</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-877457132">
										<pre class="prettyprint linenums">select    C.Name as Genre,
          extract(Year from A.ReleaseDate) as ReleaseYear,
          Sum(A.Revenue) as Revenue,
          Sum(A.Budget) as Budget
from      ((Movies A
            Join Categories B on (A.MovieId = B.MovieId))
           Join Genres C on (B.GenreId = C.GenreId))
group by  extract(Year from A.ReleaseDate),
          C.Name
having    sum(revenue) >= 100000000
and       sum(budget) between 10000000 and 50000000</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-877457132">
										<pre class="prettyprint linenums">select    C.Name as Genre,
          Year(A.ReleaseDate) as ReleaseYear,
          Sum(A.Revenue) as Revenue,
          Sum(A.Budget) as Budget
from      ((Movies A
            Join Categories B on (A.MovieId = B.MovieId))
           Join Genres C on (B.GenreId = C.GenreId))
group by  Year(A.ReleaseDate),
          C.Name
having    sum(revenue) >= 100000000
and       sum(budget) between 10000000 and 50000000</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-877457132">
										<pre class="prettyprint linenums">select    C.Name as Genre,
          extract(Year from A.ReleaseDate) as ReleaseYear,
          Sum(A.Revenue) as Revenue,
          Sum(A.Budget) as Budget
from      ((Movies A
            Join Categories B on (A.MovieId = B.MovieId))
           Join Genres C on (B.GenreId = C.GenreId))
group by  extract(Year from A.ReleaseDate),
          C.Name
having    sum(revenue) >= 100000000
and       sum(budget) between 10000000 and 50000000</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>




				<h3>Exercises</h3>







				<div class="exercise bottom20">

					<ol>
						<li>Which movie company has produced over 100 movies and has total revenues over 10000000000?
						</li>
					</ol>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-1270882950" aria-expanded="false"
						aria-controls="collapse-aria-controls-1270882950">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-1270882950">


						<pre class="prettyprint linenums">select    A.Name as Name,
          Sum(C.Budget) as Budget,
          Sum(C.Revenue) as Revenue,
          Count(*) as Movies
from      ((Companies A
            Join Backers B on (A.CompanyId = B.CompanyId))
           Join Movies C on (B.MovieId = C.MovieId))
group by  A.Name
having    Count(*) >= 100
And       Sum(C.Revenue) >= 10000000000</pre>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="2">
						<li>Show the:</li>
					</ol>
					<ul>
						<li>Crew member name</li>
						<li>Language</li>
						<li>Department name</li>
						<li>Job title</li>
						<li>Job count</li>
					</ul>
					<p>for all crew members who have worked at least 5 times on movies in a language other than English.
					</p>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-411592882" aria-expanded="false"
						aria-controls="collapse-aria-controls-411592882">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-411592882">


						<pre class="prettyprint linenums">select    A.Name as CrewMember,
          E.Name as Language,
          G.Name as DepartmentName,
          F.Title as JobTitle,
          Count(*) as JobCount
from      ((((((Creatives A
                Join Crew B on (A.CreativeId = B.CreativeId))
               Join Movies C on (B.MovieId = C.MovieId))
              Join Translations D on (C.MovieId = D.MovieId))
             Join Languages E on (D.LanguageId = E.LanguageId))
            Join Jobs F on (B.JobId = F.JobId))
           Join Departments G on (F.DepartmentId = G.DepartmentId))
where     E.Name != 'English'
group by  A.Name,
          E.Name,
          F.Title,
          G.Name
having    Count(*) >= 5</pre>


					</div>

				</div>





				<section id="order-by">
					<div class="page-header">
						<h1>Order By</h1>
						<a href="javascript:;">To top <i class="icon-arrow-up"></i></a>
					</div>
				</section>


				<h3>Syntax Review</h3>





				<div class="syntax">

					<p>The sort order of results is determined by the <em>order by</em> clause. Query results can be
						ordered on multiple columns either:</p>
					<ul>
						<li>Ascending (asc)</li>
						<li>Descending (asc)</li>
					</ul>
					<p>The default sort order is ascending unless specified otherwise.</p>
					<p>Multiple columns in the order by clause should be separated by commas.</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							All movies ordered by MovieId in ascending order
						</div>
						<div class="panel-body">
							<div>


								<pre class="prettyprint linenums">select    *
from      Movies
order by  MovieId</pre>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">




					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							All movies ordered by title in ascending order
						</div>
						<div class="panel-body">
							<div>


								<pre class="prettyprint linenums">select    *
from      Movies
order by  Title asc</pre>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">




					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							All movies ordered first by release year in descending order, then by title
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-671003243" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-671003243" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-671003243" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-671003243" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-671003243">
										<pre class="prettyprint linenums">select    MovieId,
          Title,
          DatePart(Year, ReleaseDate) as ReleaseYear
from      Movies
order by  DatePart(Year, ReleaseDate) desc,
          Title</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-671003243">
										<pre class="prettyprint linenums">select    MovieId,
          Title,
          extract(Year from ReleaseDate) as ReleaseYear
from      Movies
order by  extract(Year from ReleaseDate) desc,
          Title</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-671003243">
										<pre class="prettyprint linenums">select    MovieId,
          Title,
          Year(ReleaseDate) as ReleaseYear
from      Movies
order by  Year(ReleaseDate) desc,
          Title</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-671003243">
										<pre class="prettyprint linenums">select    MovieId,
          Title,
          extract(Year from ReleaseDate) as ReleaseYear
from      Movies
order by  extract(Year from ReleaseDate) desc,
          Title</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>




				<h3>Exercises</h3>







				<div class="exercise bottom20">

					<ol>
						<li>What is the distinct list of movie directors that Maggie Smith as ever acted for?</li>
					</ol>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-1787200029" aria-expanded="false"
						aria-controls="collapse-aria-controls-1787200029">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-1787200029">


						<pre class="prettyprint linenums">select distinct   E.Name as Director
from              (((((Movies A
                       Join [Cast] B on (A.MovieId = B.MovieId))
                      Join Actors C on (B.ActorId = C.ActorId))
                     Join Crew D on (A.MovieId = D.MovieId))
                    Join Creatives E on (D.CreativeId = E.CreativeId))
                   Join Jobs F on (D.JobId = F.JobId))
where             F.Title = 'Director'
And               C.Name = 'Maggie Smith'</pre>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="2">
						<li>What is the distinct list of countries that Liam Neeson has ever filmed in?</li>
					</ol>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-371367842" aria-expanded="false"
						aria-controls="collapse-aria-controls-371367842">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-371367842">


						<pre class="prettyprint linenums">select distinct   E.Name as Name
from              ((((Movies A
                      Join [Cast] B on (A.MovieId = B.MovieId))
                     Join Actors C on (B.ActorId = C.ActorId))
                    Join Locations D on (A.MovieId = D.MovieId))
                   Join Countries E on (D.CountryId = E.CountryId))
where             C.Name = 'Liam Neeson'</pre>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="3">
						<li>Show the distinct department, job title and name of each creative from the art department
							who has ever worked with George Lucas as a creative.</li>
					</ol>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-348914823" aria-expanded="false"
						aria-controls="collapse-aria-controls-348914823">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-348914823">


						<pre class="prettyprint linenums">select distinct   G.Name as Department,
                  F.Title as Title,
                  E.Name as Creative
from              ((((((Movies A
                        Join Crew B on (A.MovieId = B.MovieId))
                       Join Creatives C on (B.CreativeId = C.CreativeId))
                      Join Crew D on (A.MovieId = D.MovieId))
                     Join Creatives E on (D.CreativeId = E.CreativeId))
                    Join Jobs F on (D.JobId = F.JobId))
                   Join Departments G on (F.DepartmentId = G.DepartmentId))
where             C.Name = 'George Lucas'
And               G.Name = 'Art'</pre>


					</div>

				</div>





				<section id="parameters">
					<div class="page-header">
						<h1>Parameters</h1>
						<a href="javascript:;">To top <i class="icon-arrow-up"></i></a>
					</div>
				</section>


				<h3>Syntax Review</h3>





				<div class="syntax">

					<p>Parameters are values supplied at runtime that can be used in a query to influence the behavior,
						and can also be used to help prevent against sql injection attacks.</p>
					<p>They can be used in the following clauses of the query:</p>
					<ul>
						<li>Select</li>
						<li>Where</li>
						<li>Having</li>
					</ul>
					<p>In Microsoft SQL Server, the parameter value must begin with the <strong>@</strong> symbol.</p>
					<p>In Oracle, Postgres, and MySQL the parameter value must begin with the <strong>:</strong> symbol.
					</p>
					<p>Runtime parameters may not be supported by all query/reporting tools.</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Show all movies released in a given year using a parameter
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-1831045278" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-1831045278" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-1831045278" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-1831045278" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-1831045278">
										<pre class="prettyprint linenums">select    A.MovieId as MovieId,
          A.Title as Title,
          DatePart(Year, A.ReleaseDate) as ReleaseYear
from      Movies A
where     DatePart(Year, A.ReleaseDate) = @ReleaseYear
order by  A.Title</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-1831045278">
										<pre class="prettyprint linenums">select    A.MovieId as MovieId,
          A.Title as Title,
          extract(Year from A.ReleaseDate) as ReleaseYear
from      Movies A
where     extract(Year from A.ReleaseDate) = :ReleaseYear
order by  A.Title</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-1831045278">
										<pre class="prettyprint linenums">select    A.MovieId as MovieId,
          A.Title as Title,
          Year(A.ReleaseDate) as ReleaseYear
from      Movies A
where     Year(A.ReleaseDate) = :ReleaseYear
order by  A.Title</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-1831045278">
										<pre class="prettyprint linenums">select    A.MovieId as MovieId,
          A.Title as Title,
          extract(Year from A.ReleaseDate) as ReleaseYear
from      Movies A
where     extract(Year from A.ReleaseDate) = :ReleaseYear
order by  A.Title</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">




					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							List all movies that two actors appeared in together
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-714076111" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-714076111" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-714076111" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-714076111" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-714076111">
										<pre class="prettyprint linenums">select    A.MovieId as MovieId,
          A.Title as Title,
          A.ReleaseDate as ReleaseDate,
          C.Name as FirstActor,
          E.Name as SecondActor
from      ((((Movies A
              Join [Cast] B on (A.MovieId = B.MovieId))
             Join Actors C on (B.ActorId = C.ActorId))
            Join [Cast] D on (A.MovieId = D.MovieId))
           Join Actors E on (D.ActorId = E.ActorId))
where     C.Name = @FirstActor
And       E.Name = @SecondActor</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-714076111">
										<pre class="prettyprint linenums">select    A.MovieId as MovieId,
          A.Title as Title,
          A.ReleaseDate as ReleaseDate,
          C.Name as FirstActor,
          E.Name as SecondActor
from      ((((Movies A
              Join [Cast] B on (A.MovieId = B.MovieId))
             Join Actors C on (B.ActorId = C.ActorId))
            Join [Cast] D on (A.MovieId = D.MovieId))
           Join Actors E on (D.ActorId = E.ActorId))
where     C.Name = :FirstActor
And       E.Name = :SecondActor</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-714076111">
										<pre class="prettyprint linenums">select    A.MovieId as MovieId,
          A.Title as Title,
          A.ReleaseDate as ReleaseDate,
          C.Name as FirstActor,
          E.Name as SecondActor
from      ((((Movies A
              Join [Cast] B on (A.MovieId = B.MovieId))
             Join Actors C on (B.ActorId = C.ActorId))
            Join [Cast] D on (A.MovieId = D.MovieId))
           Join Actors E on (D.ActorId = E.ActorId))
where     C.Name = :FirstActor
And       E.Name = :SecondActor</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-714076111">
										<pre class="prettyprint linenums">select    A.MovieId as MovieId,
          A.Title as Title,
          A.ReleaseDate as ReleaseDate,
          C.Name as FirstActor,
          E.Name as SecondActor
from      ((((Movies A
              Join [Cast] B on (A.MovieId = B.MovieId))
             Join Actors C on (B.ActorId = C.ActorId))
            Join [Cast] D on (A.MovieId = D.MovieId))
           Join Actors E on (D.ActorId = E.ActorId))
where     C.Name = :FirstActor
And       E.Name = :SecondActor</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>




				<h3>Exercises</h3>







				<div class="exercise bottom20">

					<ol>
						<li>Show the:</li>
					</ol>
					<ul>
						<li>Actor name</li>
						<li>Movie release year</li>
						<li>Movie title</li>
						<li>Character</li>
					</ul>
					<p>ordered by:</p>
					<ul>
						<li>Movie release year (descending)</li>
						<li>Title (ascending)</li>
					</ul>
					<p>for each of:</p>
					<ul>
						<li>Liam Neeson</li>
						<li>Cate Blanchett</li>
						<li>Anne Hathaway</li>
					</ul>
					<p>without modifying the where clause of the query for each different actor.</p>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-1566678181" aria-expanded="false"
						aria-controls="collapse-aria-controls-1566678181">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-1566678181">


						<ul class="nav nav-tabs" role="tablist">
							<li role="presentation" class="active"><a href="#sql-server-1566678181" role="tab"
									data-toggle="tab">Microsoft SQL Server</a></li>
							<li role="presentation"><a href="#oracle-1566678181" role="tab" data-toggle="tab">Oracle</a>
							</li>
							<li role="presentation"><a href="#mysql-1566678181" role="tab" data-toggle="tab">MySQL</a>
							</li>
							<li role="presentation"><a href="#postgres-1566678181" role="tab"
									data-toggle="tab">Postgres</a></li>
						</ul>

						<div class="tab-content">
							<div role="tabpanel" class="tab-pane active" id="sql-server-1566678181">
								<pre class="prettyprint linenums">select    C.Name as Name,
          DatePart(Year, A.ReleaseDate) as ReleaseYear,
          A.Title as Title,
          B.[Character] as [Character]
from      ((Movies A
            Join [Cast] B on (A.MovieId = B.MovieId))
           Join Actors C on (B.ActorId = C.ActorId))
where     C.Name = @Actor
order by  DatePart(Year, A.ReleaseDate) desc,
          A.Title asc</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="oracle-1566678181">
								<pre class="prettyprint linenums">select    C.Name as Name,
          extract(Year from A.ReleaseDate) as ReleaseYear,
          A.Title as Title,
          B.Character as Character
from      ((Movies A
            Join "Cast" B on (A.MovieId = B.MovieId))
           Join Actors C on (B.ActorId = C.ActorId))
where     C.Name = :Actor
order by  extract(Year from A.ReleaseDate) desc,
          A.Title asc</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="mysql-1566678181">
								<pre class="prettyprint linenums">select    C.Name as Name,
          Year(A.ReleaseDate) as ReleaseYear,
          A.Title as Title,
          B.`Character` as `Character`
from      ((Movies A
            Join `Cast` B on (A.MovieId = B.MovieId))
           Join Actors C on (B.ActorId = C.ActorId))
where     C.Name = :Actor
order by  Year(A.ReleaseDate) desc,
          A.Title asc</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="postgres-1566678181">
								<pre class="prettyprint linenums">select    C.Name as Name,
          extract(Year from A.ReleaseDate) as ReleaseYear,
          A.Title as Title,
          B.Character as Character
from      ((Movies A
            Join "Cast" B on (A.MovieId = B.MovieId))
           Join Actors C on (B.ActorId = C.ActorId))
where     C.Name = :Actor
order by  extract(Year from A.ReleaseDate) desc,
          A.Title asc</pre>
							</div>
						</div>


					</div>

				</div>





				<section id="views">
					<div class="page-header">
						<h1>Views</h1>
						<a href="javascript:;">To top <i class="icon-arrow-up"></i></a>
					</div>
				</section>


				<h3>Syntax Review</h3>





				<div class="syntax">

					<p>If you have appropriate permissions to create objects in the database, you can store a query
						definition as a view.</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Create A New Table Based On A Query Result Set
						</div>
						<div class="panel-body">
							<div>


								<pre class="prettyprint linenums">Create view SupplierReorderReportView as
select    A.CompanyName as CompanyName,
          C.CategoryName as CategoryName,
          B.ProductName as ProductName,
          B.UnitsOnOrder as UnitsOnOrder
from      ((Partners.Suppliers A
            Join Inventory.Products B on (A.SupplierID = B.SupplierID))
           Join Inventory.Categories C on (B.CategoryID = C.CategoryID))
where     B.UnitsOnOrder > 0
order by  A.CompanyName asc,
          C.CategoryName asc,
          B.ProductName asc</pre>


							</div>
						</div>
					</div>

				</div>





				<section id="metadata">
					<div class="page-header">
						<h1>Metadata</h1>
						<a href="javascript:;">To top <i class="icon-arrow-up"></i></a>
					</div>
				</section>


				<h3>Syntax Review</h3>





				<div class="syntax">

					<p>Select the:</p>
					<ul>
						<li>Schema name</li>
						<li>Table name</li>
						<li>Constraint name (primary key name)</li>
						<li>Column name</li>
						<li>Column index position</li>
						<li>Column data type</li>
						<li>Column nullability</li>
					</ul>
					<p>for all the primary keys in the business database.</p>
					<p>All the constraint names either start with the letters 'PK' or are named 'PRIMARY'. Take into
						consideration the fact the the database might automatically convert names to upper or lower case
						by default.</p>
					<p>For Microsoft SQL Server, MySQL and Postgres, you can refer to the following views:</p>
					<ul>
						<li>INFORMATION_SCHEMA.KEY_COLUMN_USAGE</li>
						<li>INFORMATION_SCHEMA.COLUMNS</li>
					</ul>
					<p>For Oracle, you can refer to the following views:</p>
					<ul>
						<li>ALL_CONSTRAINTS</li>
						<li>ALL_CONS_COLUMNS</li>
						<li>ALL_TAB_COLUMNS</li>
					</ul>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Example
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-559779625" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-559779625" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-559779625" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-559779625" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-559779625">
										<pre class="prettyprint linenums">select    B.TABLE_SCHEMA as TABLE_SCHEMA,
          B.TABLE_NAME as TABLE_NAME,
          B.CONSTRAINT_NAME as CONSTRAINT_NAME,
          B.COLUMN_NAME as COLUMN_NAME,
          B.ORDINAL_POSITION as ORDINAL_POSITION,
          A.DATA_TYPE as DATA_TYPE,
          A.IS_NULLABLE as IS_NULLABLE
from      (INFORMATION_SCHEMA.KEY_COLUMN_USAGE B
           Join INFORMATION_SCHEMA.COLUMNS A on (B.TABLE_CATALOG = A.TABLE_CATALOG and B.TABLE_SCHEMA = A.TABLE_SCHEMA and B.TABLE_NAME = A.TABLE_NAME and B.COLUMN_NAME = A.COLUMN_NAME))
where     B.TABLE_SCHEMA in ('Geography', 'HumanResources', 'Inventory', 'Partners', 'Sales')
And       (B.CONSTRAINT_NAME like 'PK%' Or B.CONSTRAINT_NAME = 'PRIMARY')
order by  B.TABLE_SCHEMA asc,
          B.TABLE_NAME asc,
          B.ORDINAL_POSITION asc</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-559779625">
										<pre class="prettyprint linenums">select    A.OWNER as OWNER,
          A.TABLE_NAME as TABLE_NAME,
          A.CONSTRAINT_NAME as CONSTRAINT_NAME,
          B.COLUMN_NAME as COLUMN_NAME,
          B.POSITION as POSITION,
          C.DATA_TYPE as DATA_TYPE,
          C.NULLABLE as NULLABLE
from      ((ALL_CONSTRAINTS A
            Join ALL_CONS_COLUMNS B on (A.CONSTRAINT_NAME = B.CONSTRAINT_NAME and A.OWNER = B.OWNER))
           Join ALL_TAB_COLUMNS C on (B.COLUMN_NAME = C.COLUMN_NAME and B.TABLE_NAME = C.TABLE_NAME and B.OWNER = C.OWNER))
where     A.OWNER in ('GEOGRAPHY', 'HUMANRESOURCES', 'INVENTORY', 'PARTNERS', 'SALES')
And       (A.CONSTRAINT_NAME like 'PK%' Or A.CONSTRAINT_NAME = 'PRIMARY')
order by  A.OWNER asc,
          A.TABLE_NAME asc,
          B.POSITION asc</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-559779625">
										<pre class="prettyprint linenums">select    A.TABLE_SCHEMA as TABLE_SCHEMA,
          A.TABLE_NAME as TABLE_NAME,
          A.CONSTRAINT_NAME as CONSTRAINT_NAME,
          A.COLUMN_NAME as COLUMN_NAME,
          A.ORDINAL_POSITION as ORDINAL_POSITION,
          B.DATA_TYPE as DATA_TYPE,
          B.IS_NULLABLE as IS_NULLABLE
from      (information_schema.KEY_COLUMN_USAGE A
           Join information_schema.`COLUMNS` B on (A.COLUMN_NAME = B.COLUMN_NAME and A.TABLE_NAME = B.TABLE_NAME and A.TABLE_SCHEMA = B.TABLE_SCHEMA and A.TABLE_CATALOG = B.TABLE_CATALOG))
where     A.TABLE_SCHEMA in ('geography', 'humanresources', 'inventory', 'partners', 'sales')
And       (A.CONSTRAINT_NAME like 'PK%' Or A.CONSTRAINT_NAME = 'PRIMARY')</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-559779625">
										<pre class="prettyprint linenums">select    A.table_schema as table_schema,
          A."table_name" as "table_name",
          A."constraint_name" as "constraint_name",
          A."column_name" as "column_name",
          A.ordinal_position as ordinal_position,
          B.is_nullable as is_nullable,
          B.data_type as data_type
from      (information_schema.key_column_usage A
           Join information_schema.columns B on (A."column_name" = B."column_name" and A."table_name" = B."table_name" and A.table_schema = B.table_schema and A.table_catalog = B.table_catalog))
where     A.table_schema in ('geography', 'humanresources', 'inventory', 'partners', 'sales')
And       (A."constraint_name" like 'pk%' Or A."constraint_name" = 'PRIMARY')</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>





				<section id="subqueries">
					<div class="page-header">
						<h1>Subqueries</h1>
						<a href="javascript:;">To top <i class="icon-arrow-up"></i></a>
					</div>
				</section>


				<h3>Syntax Review</h3>





				<div class="syntax">

					<p>Subqueries allow you to execute queries within queries. A subquery result is normally referred to
						as a derived table.</p>
					<p>Subqueries can be used in the following clauses:</p>
					<ul>
						<li>Select</li>
						<li>From</li>
						<li>Where</li>
						<li>Having</li>
					</ul>
					<p>A subquery in the select clause must return a single row and a single column.</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Show all product categories and a sum of revenue for each
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-1856594923" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-1856594923" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-1856594923" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-1856594923" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-1856594923">
										<pre class="prettyprint linenums">select    A.CategoryName as CategoryName,
          ( select    Sum(D.Quantity * D.UnitPrice) as TotalSales
            from      (Sales.[Order Details] D
                       Join Inventory.Products C on (C.ProductID = D.ProductID))
            where     A.CategoryID = C.CategoryID
            and       C.ProductID = D.ProductID ) as TotalSales
from      Inventory.Categories A
order by  A.CategoryName asc</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-1856594923">
										<pre class="prettyprint linenums">select    A.CategoryName as CategoryName,
          ( select    Sum(D.Quantity * D.UnitPrice) as TotalSales
            from      (Sales."Order Details" D
                       Join Inventory.Products C on (C.ProductID = D.ProductID))
            where     A.CategoryID = C.CategoryID
            and       C.ProductID = D.ProductID ) as TotalSales
from      Inventory.Categories A
order by  A.CategoryName asc</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-1856594923">
										<pre class="prettyprint linenums">select    A.CategoryName as CategoryName,
          ( select    Sum(D.Quantity * D.UnitPrice) as TotalSales
            from      (Sales.`Order Details` D
                       Join Inventory.Products C on (C.ProductID = D.ProductID))
            where     A.CategoryID = C.CategoryID
            and       C.ProductID = D.ProductID ) as TotalSales
from      Inventory.Categories A
order by  A.CategoryName asc</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-1856594923">
										<pre class="prettyprint linenums">select    A.CategoryName as CategoryName,
          ( select    Sum(D.Quantity * D.UnitPrice) as TotalSales
            from      (Sales."Order Details" D
                       Join Inventory.Products C on (C.ProductID = D.ProductID))
            where     A.CategoryID = C.CategoryID
            and       C.ProductID = D.ProductID ) as TotalSales
from      Inventory.Categories A
order by  A.CategoryName asc</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">

					<p>A subquery in the from clause may return multiple rows and multiple columns.</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Show Total Sales For Products By Category
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-930632641" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-930632641" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-930632641" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-930632641" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-930632641">
										<pre class="prettyprint linenums">select    A.CategoryName as CategoryName,
          A.ProductName as ProductName,
          B.TotalSales as TotalSales
from      (( select    D.ProductID as ProductID,
                       D.ProductName as ProductName,
                       C.CategoryName as CategoryName
             from      (Inventory.Categories C
                        Join Inventory.Products D on (C.CategoryID = D.CategoryID)) ) A
           Join ( select    H.ProductID as ProductID,
                            Sum(H.UnitPrice * H.Quantity) as TotalSales
                  from      Sales.[Order Details] H
                  group by  H.ProductID ) B on (A.ProductID = B.ProductID))

          order by  A.CategoryName asc,
                    A.ProductName asc</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-930632641">
										<pre class="prettyprint linenums">select    A.CategoryName as CategoryName,
          A.ProductName as ProductName,
          B.TotalSales as TotalSales
from      (( select    D.ProductID as ProductID,
                       D.ProductName as ProductName,
                       C.CategoryName as CategoryName
             from      (Inventory.Categories C
                        Join Inventory.Products D on (C.CategoryID = D.CategoryID)) ) A
           Join ( select    H.ProductID as ProductID,
                            Sum(H.UnitPrice * H.Quantity) as TotalSales
                  from      Sales."Order Details" H
                  group by  H.ProductID ) B on (A.ProductID = B.ProductID))

          order by  A.CategoryName asc,
                    A.ProductName asc</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-930632641">
										<pre class="prettyprint linenums">select    A.CategoryName as CategoryName,
          A.ProductName as ProductName,
          B.TotalSales as TotalSales
from      (( select    D.ProductID as ProductID,
                       D.ProductName as ProductName,
                       C.CategoryName as CategoryName
             from      (Inventory.Categories C
                        Join Inventory.Products D on (C.CategoryID = D.CategoryID)) ) A
           Join ( select    H.ProductID as ProductID,
                            Sum(H.UnitPrice * H.Quantity) as TotalSales
                  from      Sales.`Order Details` H
                  group by  H.ProductID ) B on (A.ProductID = B.ProductID))

          order by  A.CategoryName asc,
                    A.ProductName asc</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-930632641">
										<pre class="prettyprint linenums">select    A.CategoryName as CategoryName,
          A.ProductName as ProductName,
          B.TotalSales as TotalSales
from      (( select    D.ProductID as ProductID,
                       D.ProductName as ProductName,
                       C.CategoryName as CategoryName
             from      (Inventory.Categories C
                        Join Inventory.Products D on (C.CategoryID = D.CategoryID)) ) A
           Join ( select    H.ProductID as ProductID,
                            Sum(H.UnitPrice * H.Quantity) as TotalSales
                  from      Sales."Order Details" H
                  group by  H.ProductID ) B on (A.ProductID = B.ProductID))

          order by  A.CategoryName asc,
                    A.ProductName asc</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">

					<p>A subquery in the where or having clauses may return multiple rows and a single column.</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Show Products That Have At Least One Sale
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-1145317359" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-1145317359" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-1145317359" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-1145317359" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-1145317359">
										<pre class="prettyprint linenums">select    A.ProductID as ProductID,
          A.ProductName as ProductName
from      Inventory.Products A
where     A.ProductID in ( select    C.ProductID as ProductID
                           from      Sales.[Order Details] C)</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-1145317359">
										<pre class="prettyprint linenums">select    A.ProductID as ProductID,
          A.ProductName as ProductName
from      Inventory.Products A
where     A.ProductID in ( select    C.ProductID as ProductID
                           from      Sales."Order Details" C)</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-1145317359">
										<pre class="prettyprint linenums">select    A.ProductID as ProductID,
          A.ProductName as ProductName
from      Inventory.Products A
where     A.ProductID in ( select    C.ProductID as ProductID
                           from      Sales.`Order Details` C)</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-1145317359">
										<pre class="prettyprint linenums">select    A.ProductID as ProductID,
          A.ProductName as ProductName
from      Inventory.Products A
where     A.ProductID in ( select    C.ProductID as ProductID
                           from      Sales."Order Details" C)</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">

					<p>Using <strong>exists</strong> allows in list comparisons to perform much quicker.</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Show Products That Have At Least One Sale
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-1567368050" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-1567368050" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-1567368050" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-1567368050" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-1567368050">
										<pre class="prettyprint linenums">select    A.ProductID as ProductID,
          A.ProductName as ProductName
from      Inventory.Products A
where     exists ( select    C.ProductID as ProductID
                   from      Sales.[Order Details] C
                   where     C.ProductId = A.ProductId )</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-1567368050">
										<pre class="prettyprint linenums">select    A.ProductID as ProductID,
          A.ProductName as ProductName
from      Inventory.Products A
where     exists ( select    C.ProductID as ProductID
                   from      Sales."Order Details" C
                   where     C.ProductId = A.ProductId )</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-1567368050">
										<pre class="prettyprint linenums">select    A.ProductID as ProductID,
          A.ProductName as ProductName
from      Inventory.Products A
where     exists ( select    C.ProductID as ProductID
                   from      Sales.`Order Details` C
                   where     C.ProductId = A.ProductId )</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-1567368050">
										<pre class="prettyprint linenums">select    A.ProductID as ProductID,
          A.ProductName as ProductName
from      Inventory.Products A
where     exists ( select    C.ProductID as ProductID
                   from      Sales."Order Details" C
                   where     C.ProductId = A.ProductId )</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>




				<h3>Exercises</h3>







				<div class="exercise bottom20">

					<ol>
						<li>Create a subquery that joins the Categories and Products tables from the Inventory schema
							together. Select the following columns:</li>
					</ol>
					<ul>
						<li>Category ID</li>
						<li>Category Name</li>
						<li>Product ID</li>
						<li>Product Name</li>
					</ul>
					<p>In the main query, select the following columns from the subquery:</p>
					<ul>
						<li>Category Name</li>
						<li>Product Name</li>
					</ul>
					<p>Order the results by:</p>
					<ul>
						<li>Category Name</li>
						<li>Product Name</li>
					</ul>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-1427268888" aria-expanded="false"
						aria-controls="collapse-aria-controls-1427268888">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-1427268888">


						<pre class="prettyprint linenums">select    A.CategoryName as CategoryName,
          A.ProductName as ProductName
from      ( select    C.ProductName as ProductName,
                      C.ProductID as ProductID,
                      B.CategoryName as CategoryName,
                      B.CategoryID as CategoryID
            from      (Inventory.Categories B
                       Join Inventory.Products C on (B.CategoryID = C.CategoryID)) ) A
order by  A.CategoryName asc,
          A.ProductName asc</pre>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="2">
						<li>Show the category name along with a subquery total of all sales for that category.</li>
					</ol>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-1617372683" aria-expanded="false"
						aria-controls="collapse-aria-controls-1617372683">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-1617372683">


						<ul class="nav nav-tabs" role="tablist">
							<li role="presentation" class="active"><a href="#sql-server-1617372683" role="tab"
									data-toggle="tab">Microsoft SQL Server</a></li>
							<li role="presentation"><a href="#oracle-1617372683" role="tab" data-toggle="tab">Oracle</a>
							</li>
							<li role="presentation"><a href="#mysql-1617372683" role="tab" data-toggle="tab">MySQL</a>
							</li>
							<li role="presentation"><a href="#postgres-1617372683" role="tab"
									data-toggle="tab">Postgres</a></li>
						</ul>

						<div class="tab-content">
							<div role="tabpanel" class="tab-pane active" id="sql-server-1617372683">
								<pre class="prettyprint linenums">select    A.CategoryName as CategoryName,
          ( select    Sum(D.UnitPrice * D.Quantity) as Total
            from      (Sales.[Order Details] D
                       Join Inventory.Products C on (C.ProductID = D.ProductID))
            where     C.ProductID = D.ProductID
            and       A.CategoryID = C.SupplierID ) as Total
from      Inventory.Categories A</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="oracle-1617372683">
								<pre class="prettyprint linenums">select    A.CategoryName as CategoryName,
          ( select    Sum(D.UnitPrice * D.Quantity) as Total
            from      (Sales."Order Details" D
                       Join Inventory.Products C on (C.ProductID = D.ProductID))
            where     C.ProductID = D.ProductID
            and       A.CategoryID = C.SupplierID ) as Total
from      Inventory.Categories A</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="mysql-1617372683">
								<pre class="prettyprint linenums">select    A.CategoryName as CategoryName,
          ( select    Sum(D.UnitPrice * D.Quantity) as Total
            from      (Sales.`Order Details` D
                       Join Inventory.Products C on (C.ProductID = D.ProductID))
            where     C.ProductID = D.ProductID
            and       A.CategoryID = C.SupplierID ) as Total
from      Inventory.Categories A</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="postgres-1617372683">
								<pre class="prettyprint linenums">select    A.CategoryName as CategoryName,
          ( select    Sum(D.UnitPrice * D.Quantity) as Total
            from      (Sales."Order Details" D
                       Join Inventory.Products C on (C.ProductID = D.ProductID))
            where     C.ProductID = D.ProductID
            and       A.CategoryID = C.SupplierID ) as Total
from      Inventory.Categories A</pre>
							</div>
						</div>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="3">
						<li>Show the:</li>
					</ol>
					<ul>
						<li>ID</li>
						<li>Name</li>
						<li>Order Total</li>
					</ul>
					<p>for all customers having total sales above the average total sale per customer. Order the results
						by total sales in descending order.</p>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-1014441260" aria-expanded="false"
						aria-controls="collapse-aria-controls-1014441260">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-1014441260">


						<ul class="nav nav-tabs" role="tablist">
							<li role="presentation" class="active"><a href="#sql-server-1014441260" role="tab"
									data-toggle="tab">Microsoft SQL Server</a></li>
							<li role="presentation"><a href="#oracle-1014441260" role="tab" data-toggle="tab">Oracle</a>
							</li>
							<li role="presentation"><a href="#mysql-1014441260" role="tab" data-toggle="tab">MySQL</a>
							</li>
							<li role="presentation"><a href="#postgres-1014441260" role="tab"
									data-toggle="tab">Postgres</a></li>
						</ul>

						<div class="tab-content">
							<div role="tabpanel" class="tab-pane active" id="sql-server-1014441260">
								<pre class="prettyprint linenums">select    A.CustomerID as CustomerID,
          A.CompanyName as CompanyName,
          Sum(C.UnitPrice * C.Quantity) as CustomerTotal
from      ((Sales.Customers A
            Join Sales.Orders B on (A.CustomerID = B.CustomerID))
           Join Sales.[Order Details] C on (B.OrderID = C.OrderID))
group by  A.CompanyName,
          A.CustomerID
having    Sum(C.UnitPrice * C.Quantity) >= ( select    Avg(E.CustomerTotal) as CustomerTotal
                                             from      ( select    F.CustomerID as CustomerID,
                                                                   Sum(H.UnitPrice * H.Quantity) as CustomerTotal
                                                         from      ((Sales.Customers F
                                                                     Join Sales.Orders G on (F.CustomerID = G.CustomerID))
                                                                    Join Sales.[Order Details] H on (G.OrderID = H.OrderID))
                                                         group by  F.CustomerID ) E )

                                           order by  Sum(C.UnitPrice * C.Quantity) desc</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="oracle-1014441260">
								<pre class="prettyprint linenums">select    A.CustomerID as CustomerID,
          A.CompanyName as CompanyName,
          Sum(C.UnitPrice * C.Quantity) as CustomerTotal
from      ((Sales.Customers A
            Join Sales.Orders B on (A.CustomerID = B.CustomerID))
           Join Sales."Order Details" C on (B.OrderID = C.OrderID))
group by  A.CompanyName,
          A.CustomerID
having    Sum(C.UnitPrice * C.Quantity) >= ( select    Avg(E.CustomerTotal) as CustomerTotal
                                             from      ( select    F.CustomerID as CustomerID,
                                                                   Sum(H.UnitPrice * H.Quantity) as CustomerTotal
                                                         from      ((Sales.Customers F
                                                                     Join Sales.Orders G on (F.CustomerID = G.CustomerID))
                                                                    Join Sales."Order Details" H on (G.OrderID = H.OrderID))
                                                         group by  F.CustomerID ) E )

                                           order by  Sum(C.UnitPrice * C.Quantity) desc</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="mysql-1014441260">
								<pre class="prettyprint linenums">select    A.CustomerID as CustomerID,
          A.CompanyName as CompanyName,
          Sum(C.UnitPrice * C.Quantity) as CustomerTotal
from      ((Sales.Customers A
            Join Sales.Orders B on (A.CustomerID = B.CustomerID))
           Join Sales.`Order Details` C on (B.OrderID = C.OrderID))
group by  A.CompanyName,
          A.CustomerID
having    Sum(C.UnitPrice * C.Quantity) >= ( select    Avg(E.CustomerTotal) as CustomerTotal
                                             from      ( select    F.CustomerID as CustomerID,
                                                                   Sum(H.UnitPrice * H.Quantity) as CustomerTotal
                                                         from      ((Sales.Customers F
                                                                     Join Sales.Orders G on (F.CustomerID = G.CustomerID))
                                                                    Join Sales.`Order Details` H on (G.OrderID = H.OrderID))
                                                         group by  F.CustomerID ) E )

                                           order by  Sum(C.UnitPrice * C.Quantity) desc</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="postgres-1014441260">
								<pre class="prettyprint linenums">select    A.CustomerID as CustomerID,
          A.CompanyName as CompanyName,
          Sum(C.UnitPrice * C.Quantity) as CustomerTotal
from      ((Sales.Customers A
            Join Sales.Orders B on (A.CustomerID = B.CustomerID))
           Join Sales."Order Details" C on (B.OrderID = C.OrderID))
group by  A.CompanyName,
          A.CustomerID
having    Sum(C.UnitPrice * C.Quantity) >= ( select    Avg(E.CustomerTotal) as CustomerTotal
                                             from      ( select    F.CustomerID as CustomerID,
                                                                   Sum(H.UnitPrice * H.Quantity) as CustomerTotal
                                                         from      ((Sales.Customers F
                                                                     Join Sales.Orders G on (F.CustomerID = G.CustomerID))
                                                                    Join Sales."Order Details" H on (G.OrderID = H.OrderID))
                                                         group by  F.CustomerID ) E )

                                           order by  Sum(C.UnitPrice * C.Quantity) desc</pre>
							</div>
						</div>


					</div>

				</div>





				<section id="set-operations">
					<div class="page-header">
						<h1>Set Operations</h1>
						<a href="javascript:;">To top <i class="icon-arrow-up"></i></a>
					</div>
				</section>


				<h3>Syntax Review</h3>





				<div class="syntax">

					<p>Set operations allow you to combine the results of 2 or more queries. The set operations
						available include:</p>
					<ul>
						<li>Union (all)</li>
						<li>Intersect</li>
						<li>Minus</li>
					</ul>
					<p>MySQL has limited support for set operations. Unions are available, but intersect and minus are
						not.</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							All Actors And Creators
						</div>
						<div class="panel-body">
							<div>


								<pre class="prettyprint linenums">select    name
from      actors

union

select    name
from      creatives</pre>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">




					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							All Actors And Creators Including Duplicates
						</div>
						<div class="panel-body">
							<div>


								<pre class="prettyprint linenums">select    name
from      actors

union all

select    name
from      creatives</pre>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">




					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Actors Who Are Also Creators
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-1311090908" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-1311090908" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-1311090908" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-1311090908" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-1311090908">
										<pre class="prettyprint linenums">select    name
from      actors

intersect

select    name
from      creatives</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-1311090908">
										<pre class="prettyprint linenums">select    name
from      actors

intersect

select    name
from      creatives</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-1311090908">
										<pre class="prettyprint linenums">-- Intersect is not supported in MySQL</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-1311090908">
										<pre class="prettyprint linenums">select    name
from      actors

intersect

select    name
from      creatives</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">




					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Actors Who Are Also Creators
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-579282914" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-579282914" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-579282914" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-579282914" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-579282914">
										<pre class="prettyprint linenums">select    name
from      actors

except

select    name
from      creatives</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-579282914">
										<pre class="prettyprint linenums">select    name
from      actors

minus

select    name
from      creatives</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-579282914">
										<pre class="prettyprint linenums">-- Except is not supported in MySQL</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-579282914">
										<pre class="prettyprint linenums">select    name
from      actors

except

select    name
from      creatives</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>




				<h3>Exercises</h3>







				<div class="exercise bottom20">

					<ol>
						<li>Show the company name and telephone number for both shippers and suppliers.</li>
					</ol>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-858460611" aria-expanded="false"
						aria-controls="collapse-aria-controls-858460611">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-858460611">


						<pre class="prettyprint linenums">( select    C.CompanyName as CompanyName,
            C.Phone as Phone
  from      Partners.Shippers C )

Union

( select    D.CompanyName as CompanyName,
            D.Phone as Phone
  from      Partners.Suppliers D )</pre>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="2">
						<li>Select the list of customer city and country locations, except for city and country
							locations in which there are employees.</li>
					</ol>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-1202375181" aria-expanded="false"
						aria-controls="collapse-aria-controls-1202375181">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-1202375181">


						<ul class="nav nav-tabs" role="tablist">
							<li role="presentation" class="active"><a href="#sql-server-1202375181" role="tab"
									data-toggle="tab">Microsoft SQL Server</a></li>
							<li role="presentation"><a href="#oracle-1202375181" role="tab" data-toggle="tab">Oracle</a>
							</li>
							<li role="presentation"><a href="#mysql-1202375181" role="tab" data-toggle="tab">MySQL</a>
							</li>
							<li role="presentation"><a href="#postgres-1202375181" role="tab"
									data-toggle="tab">Postgres</a></li>
						</ul>

						<div class="tab-content">
							<div role="tabpanel" class="tab-pane active" id="sql-server-1202375181">
								<pre class="prettyprint linenums">( select    C.Country as Country,
            C.City as City
  from      Sales.Customers C )

Except

( select    D.Country as Country,
            D.City as City
  from      HumanResources.Employees D )</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="oracle-1202375181">
								<pre class="prettyprint linenums">( select    C.Country as Country,
            C.City as City
  from      Sales.Customers C )

minus

( select    D.Country as Country,
            D.City as City
  from      HumanResources.Employees D )</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="mysql-1202375181">
								<pre class="prettyprint linenums">-- MySQL does not have support for EXCEPT</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="postgres-1202375181">
								<pre class="prettyprint linenums">( select    C.Country as Country,
            C.City as City
  from      Sales.Customers C )

Except

( select    D.Country as Country,
            D.City as City
  from      HumanResources.Employees D )</pre>
							</div>
						</div>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="3">
						<li>In the movies database, select the distinct list of actors and creatives that have worked on
							movies with a runtime length over 3 hours.</li>
					</ol>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-1346567430" aria-expanded="false"
						aria-controls="collapse-aria-controls-1346567430">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-1346567430">


						<ul class="nav nav-tabs" role="tablist">
							<li role="presentation" class="active"><a href="#sql-server-1346567430" role="tab"
									data-toggle="tab">Microsoft SQL Server</a></li>
							<li role="presentation"><a href="#oracle-1346567430" role="tab" data-toggle="tab">Oracle</a>
							</li>
							<li role="presentation"><a href="#mysql-1346567430" role="tab" data-toggle="tab">MySQL</a>
							</li>
							<li role="presentation"><a href="#postgres-1346567430" role="tab"
									data-toggle="tab">Postgres</a></li>
						</ul>

						<div class="tab-content">
							<div role="tabpanel" class="tab-pane active" id="sql-server-1346567430">
								<pre class="prettyprint linenums">( select    E.Name as Name
  from      ((Movies C
              Join [Cast] D on (C.MovieId = D.MovieId))
             Join Actors E on (D.ActorId = E.ActorId))
  where     C.Runtime >= 180
  and       D.ActorId = E.ActorId
  and       C.MovieId = D.MovieId )

Union

( select    H.Name as Name
  from      ((Movies F
              Join Crew G on (F.MovieId = G.MovieId))
             Join Creatives H on (G.CreativeId = H.CreativeId))
  where     F.Runtime >= 180
  and       G.CreativeId = H.CreativeId
  and       F.MovieId = G.MovieId )</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="oracle-1346567430">
								<pre class="prettyprint linenums">( select    E.Name as Name
  from      ((Movies C
              Join Cast D on (C.MovieId = D.MovieId))
             Join Actors E on (D.ActorId = E.ActorId))
  where     C.Runtime >= 180
  and       D.ActorId = E.ActorId
  and       C.MovieId = D.MovieId )

Union

( select    H.Name as Name
  from      ((Movies F
              Join Crew G on (F.MovieId = G.MovieId))
             Join Creatives H on (G.CreativeId = H.CreativeId))
  where     F.Runtime >= 180
  and       G.CreativeId = H.CreativeId
  and       F.MovieId = G.MovieId )</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="mysql-1346567430">
								<pre class="prettyprint linenums">( select    E.Name as Name
  from      ((Movies C
              Join `Cast` D on (C.MovieId = D.MovieId))
             Join Actors E on (D.ActorId = E.ActorId))
  where     C.Runtime >= 180
  and       D.ActorId = E.ActorId
  and       C.MovieId = D.MovieId )

Union

( select    H.Name as Name
  from      ((Movies F
              Join Crew G on (F.MovieId = G.MovieId))
             Join Creatives H on (G.CreativeId = H.CreativeId))
  where     F.Runtime >= 180
  and       G.CreativeId = H.CreativeId
  and       F.MovieId = G.MovieId )</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="postgres-1346567430">
								<pre class="prettyprint linenums">( select    E.Name as Name
  from      ((Movies C
              Join "Cast" D on (C.MovieId = D.MovieId))
             Join Actors E on (D.ActorId = E.ActorId))
  where     C.Runtime >= 180
  and       D.ActorId = E.ActorId
  and       C.MovieId = D.MovieId )

Union

( select    H.Name as Name
  from      ((Movies F
              Join Crew G on (F.MovieId = G.MovieId))
             Join Creatives H on (G.CreativeId = H.CreativeId))
  where     F.Runtime >= 180
  and       G.CreativeId = H.CreativeId
  and       F.MovieId = G.MovieId )</pre>
							</div>
						</div>


					</div>

				</div>





				<section id="with-blocks">
					<div class="page-header">
						<h1>With Blocks</h1>
						<a href="javascript:;">To top <i class="icon-arrow-up"></i></a>
					</div>
				</section>


				<h3>Syntax Review</h3>





				<div class="syntax">

					<p>With Blocks allow you to pre-define subqueries that appear in the from clause of the query.</p>
					<p>The real value of a with block is the ability to recursively iterate a hierarchical data
						structure such as an organization chart.</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Recursive Hierarchical Query Using With Blocks
						</div>
						<div class="panel-body">
							<div>


								<pre class="prettyprint linenums">with      Subordinates as ( select    EmployeeId,
                                      ReportsTo,
                                      FirstName,
                                      LastName
                            from      HumanResources.Employees
                            where     ReportsTo is null

                            union all

                            select    a.EmployeeId,
                                      a.ReportsTo,
                                      a.FirstName,
                                      a.LastName
                            from      HumanResources.Employees a,
                                      Subordinates b
                            where     b.EmployeeId = a.ReportsTo )
select    *
from      Subordinates</pre>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">

					<p>With Blocks are also good for series table generation. A series table is a table that you can
						left outer join to in order to fill in gaps that may appear in your result set due to missing
						underlying actual data.</p>
					<p>For example, if you are missing sales data for a given month, and you want your result set to
						include nulls or zeros for that month, you can left join to a series table in order to provide
						the missing month rows to join against.</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Series Table Generation Using With Blocks
						</div>
						<div class="panel-body">
							<div>


								<pre class="prettyprint linenums">with      Series as ( select    1 as month

                      union all

                      select    month + 1
                      from      Series
                      where     month < 12 )
select    *
from      series</pre>


							</div>
						</div>
					</div>

				</div>




				<h3>Exercises</h3>







				<div class="exercise bottom20">

					<ol>
						<li>From the Employees table, select the:</li>
					</ol>
					<ul>
						<li>Employee ID</li>
						<li>Reports To</li>
						<li>First Name</li>
						<li>Last Name</li>
					</ul>
					<p>for the employee and all superiors, where the EmployeeId = 9</p>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-912463177" aria-expanded="false"
						aria-controls="collapse-aria-controls-912463177">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-912463177">


						<ul class="nav nav-tabs" role="tablist">
							<li role="presentation" class="active"><a href="#sql-server-912463177" role="tab"
									data-toggle="tab">Microsoft SQL Server</a></li>
							<li role="presentation"><a href="#oracle-912463177" role="tab" data-toggle="tab">Oracle</a>
							</li>
							<li role="presentation"><a href="#mysql-912463177" role="tab" data-toggle="tab">MySQL</a>
							</li>
							<li role="presentation"><a href="#postgres-912463177" role="tab"
									data-toggle="tab">Postgres</a></li>
						</ul>

						<div class="tab-content">
							<div role="tabpanel" class="tab-pane active" id="sql-server-912463177">
								<pre class="prettyprint linenums">with      Superiors as ( select    EmployeeId,
                                   ReportsTo,
                                   FirstName,
                                   LastName
                         from      HumanResources.Employees
                         where     employeeId = 9

                         union all

                         select    a.EmployeeId,
                                   a.ReportsTo,
                                   a.FirstName,
                                   a.LastName
                         from      HumanResources.Employees a,
                                   Superiors b
                         where     a.EmployeeId = b.ReportsTo )
select    *
from      Superiors</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="oracle-912463177">
								<pre class="prettyprint linenums">with      Superiors (EmployeeId, ReportsTo, FirstName, LastName) as ( select    EmployeeId,
                                                                                ReportsTo,
                                                                                FirstName,
                                                                                LastName
                                                                      from      HumanResources.Employees
                                                                      where     employeeId = 9

                                                                      union all

                                                                      select    a.EmployeeId,
                                                                                a.ReportsTo,
                                                                                a.FirstName,
                                                                                a.LastName
                                                                      from      HumanResources.Employees a,
                                                                                Superiors b
                                                                      where     a.EmployeeId = b.ReportsTo )
select    *
from      Superiors</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="mysql-912463177">
								<pre
									class="prettyprint linenums">-- MySQL does not support With blocks (common table expressions)</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="postgres-912463177">
								<pre class="prettyprint linenums">with      recursive Superiors as ( select    EmployeeId,
                                             ReportsTo,
                                             FirstName,
                                             LastName
                                   from      HumanResources.Employees
                                   where     employeeId = 9

                                   union all

                                   select    a.EmployeeId,
                                             a.ReportsTo,
                                             a.FirstName,
                                             a.LastName
                                   from      HumanResources.Employees a,
                                             Superiors b
                                   where     a.EmployeeId = b.ReportsTo )
select    *
from      Superiors</pre>
							</div>
						</div>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="2">
						<li>Generate a series table that includes the values:</li>
					</ol>
					<ul>
						<li>10</li>
						<li>20</li>
						<li>30</li>
						<li>80</li>
						<li>90</li>
						<li>100</li>
					</ul>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-499048385" aria-expanded="false"
						aria-controls="collapse-aria-controls-499048385">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-499048385">


						<ul class="nav nav-tabs" role="tablist">
							<li role="presentation" class="active"><a href="#sql-server-499048385" role="tab"
									data-toggle="tab">Microsoft SQL Server</a></li>
							<li role="presentation"><a href="#oracle-499048385" role="tab" data-toggle="tab">Oracle</a>
							</li>
							<li role="presentation"><a href="#mysql-499048385" role="tab" data-toggle="tab">MySQL</a>
							</li>
							<li role="presentation"><a href="#postgres-499048385" role="tab"
									data-toggle="tab">Postgres</a></li>
						</ul>

						<div class="tab-content">
							<div role="tabpanel" class="tab-pane active" id="sql-server-499048385">
								<pre class="prettyprint linenums">with      Series as ( select    10 as value

                      union all

                      select    value + 10
                      from      Series
                      where     value < 100 )
select    *
from      series
where     value not between 40 and 70</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="oracle-499048385">
								<pre class="prettyprint linenums">with      Series (value) as ( select    10 as value
                              from      dual

                              union all

                              select    value + 10
                              from      Series
                              where     value < 100 )
select    *
from      series
where     value not between 40 and 70</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="mysql-499048385">
								<pre
									class="prettyprint linenums">-- MySQL does not support With blocks (common table expressions)</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="postgres-499048385">
								<pre class="prettyprint linenums">with      recursive Series as ( select    10 as value

                                union all

                                select    value + 10
                                from      Series
                                where     value < 100 )
select    *
from      series
where     value not between 40 and 70</pre>
							</div>
						</div>


					</div>

				</div>





				<section id="window-functions">
					<div class="page-header">
						<h1>Window Functions</h1>
						<a href="javascript:;">To top <i class="icon-arrow-up"></i></a>
					</div>
				</section>


				<h3>Syntax Review</h3>





				<div class="syntax">

					<p>Window functions allow for powerful cross-row calculations by defining windows that contain the
						range of values to be aggregated.</p>
					<p>Window functions require:</p>
					<ul>
						<li>Summary function to be applied
							<ul>
								<li>Sum</li>
								<li>Min</li>
								<li>Max</li>
								<li>Count</li>
								<li>Avg</li>
								<li>StdDev</li>
								<li>Var</li>
								<li>Lead</li>
								<li>Lag</li>
								<li>First_Value</li>
								<li>Last_Value</li>
								<li>More depending on database and version</li>
							</ul>
						</li>
						<li>Window specification
							<ul>
								<li>keyword <strong>over</strong></li>
								<li>partition clause (optional)</li>
								<li>order by clause (optional)</li>
								<li>row range clause (optional)</li>
							</ul>
						</li>
					</ul>
					<p>Window boundaries can be from:</p>
					<ul>
						<li>Unbounded preceding</li>
						<li>Current row</li>
						<li>Unbounded following</li>
					</ul>
					<p>Window boundaries can also be a fixed number of preceding or following rows.</p>
					<p>The default window boundary is unbounded preceding to current row.</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Basic Example That Generates A Sum Over The Entire Result Set
						</div>
						<div class="panel-body">
							<div>


								<pre class="prettyprint linenums">sum(column1) over ()</pre>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">




					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Sum Of Ordered Rows
						</div>
						<div class="panel-body">
							<div>


								<pre class="prettyprint linenums">sum(column1) over (order by column4,
                            column5)</pre>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">




					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Sum Of Partitioned And Ordered Rows
						</div>
						<div class="panel-body">
							<div>


								<pre class="prettyprint linenums">sum(column1) over (partition by column2,
                                column3
                   order by column4,
                            column5)</pre>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">




					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Sum Of Partitioned And Ordered Rows With Explicit Window Bordering
						</div>
						<div class="panel-body">
							<div>


								<pre class="prettyprint linenums">sum(column1) over (partition by column2,
                                column3
                   order by column4,
                            column5
                   rows between unbounded preceding and current row)</pre>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">




					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Sum Of Partitioned And Ordered Rows With Fixed Range Boundaries
						</div>
						<div class="panel-body">
							<div>


								<pre class="prettyprint linenums">sum(column1) over (partition by column2,
                                column3
                   order by column4,
                            column5
                   rows between 2 preceding and 2 following)</pre>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">




					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Running Total Of Revenue For Brad Pitt's Movies
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-94100843" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-94100843" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-94100843" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-94100843" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-94100843">
										<pre class="prettyprint linenums">select    C.Name as Name,
          A.Title as Title,
          Lag(A.Title) over (order by A.ReleaseDate) as PreviousTitle,
          Lead(A.Title) over (order by A.ReleaseDate) as NextTitle,
          A.ReleaseDate as ReleaseDate,
          A.Revenue as Revenue,
          sum(A.Revenue) over (order by A.ReleaseDate) as RunningTotal
from      ((Movies A
            Join [Cast] B on (A.MovieId = B.MovieId))
           Join Actors C on (B.ActorId = C.ActorId))
where     C.Name = 'Brad Pitt'
order by  A.ReleaseDate asc</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-94100843">
										<pre class="prettyprint linenums">select    C.Name as Name,
          A.Title as Title,
          Lag(A.Title) over (order by A.ReleaseDate) as PreviousTitle,
          Lead(A.Title) over (order by A.ReleaseDate) as NextTitle,
          A.ReleaseDate as ReleaseDate,
          A.Revenue as Revenue,
          sum(A.Revenue) over (order by A.ReleaseDate) as RunningTotal
from      ((Movies A
            Join Cast B on (A.MovieId = B.MovieId))
           Join Actors C on (B.ActorId = C.ActorId))
where     C.Name = 'Brad Pitt'
order by  A.ReleaseDate asc</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-94100843">
										<pre
											class="prettyprint linenums">-- MySQL does not support window functions</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-94100843">
										<pre class="prettyprint linenums">select    C.Name as Name,
          A.Title as Title,
          Lag(A.Title) over (order by A.ReleaseDate) as PreviousTitle,
          Lead(A.Title) over (order by A.ReleaseDate) as NextTitle,
          A.ReleaseDate as ReleaseDate,
          A.Revenue as Revenue,
          sum(A.Revenue) over (order by A.ReleaseDate) as RunningTotal
from      ((Movies A
            Join "Cast" B on (A.MovieId = B.MovieId))
           Join Actors C on (B.ActorId = C.ActorId))
where     C.Name = 'Brad Pitt'
order by  A.ReleaseDate asc</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>




				<h3>Exercises</h3>







				<div class="exercise bottom20">

					<ol>
						<li>Write a query that shows the:</li>
					</ol>
					<ul>
						<li>Order Date</li>
						<li>Daily Sales Total</li>
						<li>Running Sales Total</li>
					</ul>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-2074303032" aria-expanded="false"
						aria-controls="collapse-aria-controls-2074303032">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-2074303032">


						<ul class="nav nav-tabs" role="tablist">
							<li role="presentation" class="active"><a href="#sql-server-2074303032" role="tab"
									data-toggle="tab">Microsoft SQL Server</a></li>
							<li role="presentation"><a href="#oracle-2074303032" role="tab" data-toggle="tab">Oracle</a>
							</li>
							<li role="presentation"><a href="#mysql-2074303032" role="tab" data-toggle="tab">MySQL</a>
							</li>
							<li role="presentation"><a href="#postgres-2074303032" role="tab"
									data-toggle="tab">Postgres</a></li>
						</ul>

						<div class="tab-content">
							<div role="tabpanel" class="tab-pane active" id="sql-server-2074303032">
								<pre class="prettyprint linenums">select    C.OrderDate as OrderDate,
          C.DailyTotal as DailyTotal,
          Sum(C.DailyTotal) over (order by C.OrderDate) as RunningTotal
from      ( select    A.OrderDate as OrderDate,
                      Sum(B.Quantity * B.UnitPrice) as DailyTotal
            from      (Sales.Orders A
                       Join Sales.[Order Details] B on (A.OrderID = B.OrderID))
            group by  A.OrderDate ) C
group by  C.OrderDate,
          C.DailyTotal
order by  C.OrderDate asc</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="oracle-2074303032">
								<pre class="prettyprint linenums">select    C.OrderDate as OrderDate,
          C.DailyTotal as DailyTotal,
          Sum(C.DailyTotal) over (order by C.OrderDate) as RunningTotal
from      ( select    A.OrderDate as OrderDate,
                      Sum(B.Quantity * B.UnitPrice) as DailyTotal
            from      (Sales.Orders A
                       Join Sales."Order Details" B on (A.OrderID = B.OrderID))
            group by  A.OrderDate ) C
group by  C.OrderDate,
          C.DailyTotal
order by  C.OrderDate asc</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="mysql-2074303032">
								<pre
									class="prettyprint linenums">-- MySQL does not have support for window functions</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="postgres-2074303032">
								<pre class="prettyprint linenums">select    C.OrderDate as OrderDate,
          C.DailyTotal as DailyTotal,
          Sum(C.DailyTotal) over (order by C.OrderDate) as RunningTotal
from      ( select    A.OrderDate as OrderDate,
                      Sum(B.Quantity * B.UnitPrice) as DailyTotal
            from      (Sales.Orders A
                       Join Sales."Order Details" B on (A.OrderID = B.OrderID))
            group by  A.OrderDate ) C
group by  C.OrderDate,
          C.DailyTotal
order by  C.OrderDate asc</pre>
							</div>
						</div>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="2">
						<li>For each customer, show the:</li>
					</ol>
					<ul>
						<li>Company Name</li>
						<li>Order Date</li>
						<li>Previous Order Date</li>
						<li>Next Order Date</li>
					</ul>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-1675449224" aria-expanded="false"
						aria-controls="collapse-aria-controls-1675449224">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-1675449224">


						<ul class="nav nav-tabs" role="tablist">
							<li role="presentation" class="active"><a href="#sql-server-1675449224" role="tab"
									data-toggle="tab">Microsoft SQL Server</a></li>
							<li role="presentation"><a href="#oracle-1675449224" role="tab" data-toggle="tab">Oracle</a>
							</li>
							<li role="presentation"><a href="#mysql-1675449224" role="tab" data-toggle="tab">MySQL</a>
							</li>
							<li role="presentation"><a href="#postgres-1675449224" role="tab"
									data-toggle="tab">Postgres</a></li>
						</ul>

						<div class="tab-content">
							<div role="tabpanel" class="tab-pane active" id="sql-server-1675449224">
								<pre class="prettyprint linenums">select    A.CompanyName as CompanyName,
          B.OrderDate as OrderDate,
          Lead(B.OrderDate) over (partition by A.CompanyName
                                  order by B.OrderDate) as NextOrderDate,
          Lag(B.OrderDate) over (partition by A.CompanyName
                                 order by B.OrderDate) as LastOrderDate
from      (Sales.Customers A
           Join Sales.Orders B on (A.CustomerID = B.CustomerID))
order by  A.CompanyName asc,
          B.OrderDate asc</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="oracle-1675449224">
								<pre class="prettyprint linenums">select    A.CompanyName as CompanyName,
          B.OrderDate as OrderDate,
          Lead(B.OrderDate) over (partition by A.CompanyName
                                  order by B.OrderDate) as NextOrderDate,
          Lag(B.OrderDate) over (partition by A.CompanyName
                                 order by B.OrderDate) as LastOrderDate
from      (Sales.Customers A
           Join Sales.Orders B on (A.CustomerID = B.CustomerID))
order by  A.CompanyName asc,
          B.OrderDate asc</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="mysql-1675449224">
								<pre
									class="prettyprint linenums">-- MySQL does not have support for window functions</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="postgres-1675449224">
								<pre class="prettyprint linenums">select    A.CompanyName as CompanyName,
          B.OrderDate as OrderDate,
          Lead(B.OrderDate) over (partition by A.CompanyName
                                  order by B.OrderDate) as NextOrderDate,
          Lag(B.OrderDate) over (partition by A.CompanyName
                                 order by B.OrderDate) as LastOrderDate
from      (Sales.Customers A
           Join Sales.Orders B on (A.CustomerID = B.CustomerID))
order by  A.CompanyName asc,
          B.OrderDate asc</pre>
							</div>
						</div>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="3">
						<li>For each employee, show:</li>
					</ol>
					<ul>
						<li>Employee Id</li>
						<li>First Name</li>
						<li>Last Name</li>
						<li>Total Of Sales</li>
						<li>Total Of Sales compared to lowest performing employee</li>
						<li>Total Of Sales compared to highest performing employee</li>
						<li>Percentage of employee's sales relative to all employees' sales</li>
					</ul>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-405282209" aria-expanded="false"
						aria-controls="collapse-aria-controls-405282209">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-405282209">


						<ul class="nav nav-tabs" role="tablist">
							<li role="presentation" class="active"><a href="#sql-server-405282209" role="tab"
									data-toggle="tab">Microsoft SQL Server</a></li>
							<li role="presentation"><a href="#oracle-405282209" role="tab" data-toggle="tab">Oracle</a>
							</li>
							<li role="presentation"><a href="#mysql-405282209" role="tab" data-toggle="tab">MySQL</a>
							</li>
							<li role="presentation"><a href="#postgres-405282209" role="tab"
									data-toggle="tab">Postgres</a></li>
						</ul>

						<div class="tab-content">
							<div role="tabpanel" class="tab-pane active" id="sql-server-405282209">
								<pre class="prettyprint linenums">select    D.EmployeeID as EmployeeID,
          D.LastName as LastName,
          D.FirstName as FirstName,
          D.Total as Total,
          D.Total - First_Value(D.Total) over (order by D.Total) as RelativeToLowest,
          Last_Value(D.Total) over (order by D.Total asc
                                    rows between current row and unbounded following) - D.Total as RelativeToHighest,
          D.Total / Sum(D.Total) over () as PercentageContribution
from      ( select    A.EmployeeID as EmployeeID,
                      A.LastName as LastName,
                      A.FirstName as FirstName,
                      Sum(C.Quantity * C.Discount) as Total
            from      ((Sales.Orders B
                        Join HumanResources.Employees A on (A.EmployeeID = B.EmployeeID))
                       Join Sales.[Order Details] C on (B.OrderID = C.OrderID))
            group by  A.FirstName,
                      A.LastName,
                      A.EmployeeID ) D
order by  D.Total asc</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="oracle-405282209">
								<pre class="prettyprint linenums">select    D.EmployeeID as EmployeeID,
          D.LastName as LastName,
          D.FirstName as FirstName,
          D.Total as Total,
          D.Total - First_Value(D.Total) over (order by D.Total) as RelativeToLowest,
          Last_Value(D.Total) over (order by D.Total asc
                                    rows between current row and unbounded following) - D.Total as RelativeToHighest,
          D.Total / Sum(D.Total) over () as PercentageContribution
from      ( select    A.EmployeeID as EmployeeID,
                      A.LastName as LastName,
                      A.FirstName as FirstName,
                      Sum(C.Quantity * C.Discount) as Total
            from      ((Sales.Orders B
                        Join HumanResources.Employees A on (A.EmployeeID = B.EmployeeID))
                       Join Sales."Order Details" C on (B.OrderID = C.OrderID))
            group by  A.FirstName,
                      A.LastName,
                      A.EmployeeID ) D
order by  D.Total asc</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="mysql-405282209">
								<pre
									class="prettyprint linenums">-- MySQL does not have support for window functions</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="postgres-405282209">
								<pre class="prettyprint linenums">select    D.EmployeeID as EmployeeID,
          D.LastName as LastName,
          D.FirstName as FirstName,
          D.Total as Total,
          D.Total - First_Value(D.Total) over (order by D.Total) as RelativeToLowest,
          Last_Value(D.Total) over (order by D.Total asc
                                    rows between current row and unbounded following) - D.Total as RelativeToHighest,
          D.Total / Sum(D.Total) over () as PercentageContribution
from      ( select    A.EmployeeID as EmployeeID,
                      A.LastName as LastName,
                      A.FirstName as FirstName,
                      Sum(C.Quantity * C.Discount) as Total
            from      ((Sales.Orders B
                        Join HumanResources.Employees A on (A.EmployeeID = B.EmployeeID))
                       Join Sales."Order Details" C on (B.OrderID = C.OrderID))
            group by  A.FirstName,
                      A.LastName,
                      A.EmployeeID ) D
order by  D.Total asc</pre>
							</div>
						</div>


					</div>

				</div>





				<section id="user-defined-functions">
					<div class="page-header">
						<h1>User Defined Functions</h1>
						<a href="javascript:;">To top <i class="icon-arrow-up"></i></a>
					</div>
				</section>


				<h3>Syntax Review</h3>





				<div class="syntax">

					<p>Write a query that shows each:</p>
					<ul>
						<li>Customer ID</li>
						<li>Customer Name</li>
						<li>Order ID</li>
						<li>Order total without sales tax</li>
						<li>Order total with sales tax calculated using a date range</li>
						<li>Sales tax percentage calculated using a date range (for example, 2012-01-01 to 2012-12-31
						</li>
						<li>Sales tax percentage calculated using a year extraction from date (for example 2012)</li>
						<li>Order total with sales tax calculated using a year extraction from date (for example 2012)
						</li>
						<li>Sales tax percentage calculated using the user-defined CalculateGstFunction</li>
						<li>Order total with sales tax calculated using the user-defined CalculateGstFunction</li>
					</ul>
					<p>The Sales tax should be calculated such that:</p>
					<ul>
						<li>In 2012, the sales tax percentage is 7%</li>
						<li>In 2013, the sales tax percentage is 6%</li>
						<li>In 2014, the sales tax percentage is 5%</li>
					</ul>
					<p>Order the results by:</p>
					<ul>
						<li>Customer ID</li>
						<li>Order ID</li>
					</ul>
					<p><strong>Hint:</strong> Write a subquery in which you determine the sales tax percentage
						calculations using the date range and year extractions. This will reduce the number of case
						statements you have to include in the overall query.</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Example
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-1366307905" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-1366307905" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-1366307905" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-1366307905" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-1366307905">
										<pre class="prettyprint linenums">select    D.CustomerID as CustomerID,
          D.CompanyName as CompanyName,
          C.OrderID as OrderID,
          C.OrderTotal as OrderTotal,
          C.SalesTaxByDateRange as SalesTaxByDateRange,
          C.OrderTotal * (1 + C.SalesTaxByDateRange) as OrderTotalWithTaxByDateRange,
          C.SalesTaxByYear as SalesTaxByYear,
          C.OrderTotal * (1 + C.SalesTaxByYear) as OrderTotalWithTaxByYear,
          C.SalesTaxByFunction as SalesTaxByFunction,
          C.OrderTotal * (1 + C.SalesTaxByFunction) as OrderTotalWithTaxByFunction
from      (Sales.Customers D
           Join ( select    A.CustomerID as CustomerID,
                            A.OrderID as OrderID,
                            Sum(B.Quantity * B.UnitPrice) as OrderTotal,
                            Avg(case
                                  when A.OrderDate between '2012-01-01' and '2012-12-31' then 0.07
                                  when A.OrderDate between '2013-01-01' and '2013-12-31' then 0.06
                                  when A.OrderDate > '2014-01-01' then 0.05
                                end) as SalesTaxByDateRange,
                            Avg(case DatePart(Year, A.OrderDate)
                                  when 2012 then 0.07
                                  when 2013 then 0.06
                                  else 0.05
                                end) as SalesTaxByYear,
                            Avg(dbo.CalculateGstPercentage(A.OrderDate)) as SalesTaxByFunction
                  from      (Sales.[Order Details] B
                             Join Sales.Orders A on (A.OrderID = B.OrderID))
                  group by  A.OrderID,
                            A.CustomerID ) C on (D.CustomerID = C.CustomerID))
order by  D.CustomerId,
          C.OrderId</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-1366307905">
										<pre class="prettyprint linenums">select    D.CustomerID as CustomerID,
          D.CompanyName as CompanyName,
          C.OrderID as OrderID,
          C.OrderTotal as OrderTotal,
          C.SalesTaxByDateRange as SalesTaxByDateRange,
          C.OrderTotal * (1 + C.SalesTaxByDateRange) as OrderTotalWithTaxByDateRange,
          C.SalesTaxByYear as SalesTaxByYear,
          C.OrderTotal * (1 + C.SalesTaxByYear) as OrderTotalWithTaxByYear,
          C.SalesTaxByFunction as SalesTaxByFunction,
          C.OrderTotal * (1 + C.SalesTaxByFunction) as OrderTotalWithTaxByFunction
from      (Sales.Customers D
           Join ( select    A.CustomerID as CustomerID,
                            A.OrderID as OrderID,
                            Sum(B.Quantity * B.UnitPrice) as OrderTotal,
                            Avg(case
                                  when A.OrderDate between to_date('2012-01-01', 'yyyy-mm-dd') and to_date('2012-12-31', 'yyyy-mm-dd') then 0.07
                                  when A.OrderDate between to_date('2013-01-01', 'yyyy-mm-dd') and to_date('2013-12-31', 'yyyy-mm-dd') then 0.06
                                  when A.OrderDate > to_date('2014-01-01', 'yyyy-mm-dd') then 0.05
                                end) as SalesTaxByDateRange,
                            Avg(case extract(Year from A.OrderDate)
                                  when 2012 then 0.07
                                  when 2013 then 0.06
                                  else 0.05
                                end) as SalesTaxByYear,
                            Avg(CalculateGstPercentage(A.OrderDate)) as SalesTaxByFunction
                  from      (Sales."Order Details" B
                             Join Sales.Orders A on (A.OrderID = B.OrderID))
                  group by  A.OrderID,
                            A.CustomerID ) C on (D.CustomerID = C.CustomerID))
order by  D.CustomerId,
          C.OrderId</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-1366307905">
										<pre class="prettyprint linenums">select    D.CustomerID as CustomerID,
          D.CompanyName as CompanyName,
          C.OrderID as OrderID,
          C.OrderTotal as OrderTotal,
          C.SalesTaxByDateRange as SalesTaxByDateRange,
          C.OrderTotal * (1 + C.SalesTaxByDateRange) as OrderTotalWithTaxByDateRange,
          C.SalesTaxByYear as SalesTaxByYear,
          C.OrderTotal * (1 + C.SalesTaxByYear) as OrderTotalWithTaxByYear,
          C.SalesTaxByFunction as SalesTaxByFunction,
          C.OrderTotal * (1 + C.SalesTaxByFunction) as OrderTotalWithTaxByFunction
from      (Sales.Customers D
           Join ( select    A.CustomerID as CustomerID,
                            A.OrderID as OrderID,
                            Sum(B.Quantity * B.UnitPrice) as OrderTotal,
                            Avg(case
                                  when A.OrderDate between '2012-01-01' and '2012-12-31' then 0.07
                                  when A.OrderDate between '2013-01-01' and '2013-12-31' then 0.06
                                  when A.OrderDate > '2014-01-01' then 0.05
                                end) as SalesTaxByDateRange,
                            Avg(case Year(A.OrderDate)
                                  when 2012 then 0.07
                                  when 2013 then 0.06
                                  else 0.05
                                end) as SalesTaxByYear,
                            Avg(CalculateGstPercentage(A.OrderDate)) as SalesTaxByFunction
                  from      (Sales.`Order Details` B
                             Join Sales.Orders A on (A.OrderID = B.OrderID))
                  group by  A.OrderID,
                            A.CustomerID ) C on (D.CustomerID = C.CustomerID))
order by  D.CustomerId,
          C.OrderId</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-1366307905">
										<pre class="prettyprint linenums">select    D.CustomerID as CustomerID,
          D.CompanyName as CompanyName,
          C.OrderID as OrderID,
          C.OrderTotal as OrderTotal,
          C.SalesTaxByDateRange as SalesTaxByDateRange,
          C.OrderTotal * (1 + C.SalesTaxByDateRange) as OrderTotalWithTaxByDateRange,
          C.SalesTaxByYear as SalesTaxByYear,
          C.OrderTotal * (1 + C.SalesTaxByYear) as OrderTotalWithTaxByYear,
          C.SalesTaxByFunction as SalesTaxByFunction,
          C.OrderTotal * (1 + C.SalesTaxByFunction) as OrderTotalWithTaxByFunction
from      (Sales.Customers D
           Join ( select    A.CustomerID as CustomerID,
                            A.OrderID as OrderID,
                            Sum(B.Quantity * B.UnitPrice) as OrderTotal,
                            Avg(case
                                  when A.OrderDate between to_date('2012-01-01', 'yyyy-mm-dd') and to_date('2012-12-31', 'yyyy-mm-dd') then 0.07
                                  when A.OrderDate between to_date('2013-01-01', 'yyyy-mm-dd') and to_date('2013-12-31', 'yyyy-mm-dd') then 0.06
                                  when A.OrderDate > to_date('2014-01-01', 'yyyy-mm-dd') then 0.05
                                end) as SalesTaxByDateRange,
                            Avg(case extract(Year from A.OrderDate)
                                  when 2012 then 0.07
                                  when 2013 then 0.06
                                  else 0.05
                                end) as SalesTaxByYear,
                            Avg(CalculateGstPercentage(A.OrderDate)) as SalesTaxByFunction
                  from      (Sales."Order Details" B
                             Join Sales.Orders A on (A.OrderID = B.OrderID))
                  group by  A.OrderID,
                            A.CustomerID ) C on (D.CustomerID = C.CustomerID))
order by  D.CustomerId,
          C.OrderId</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>





				<section id="top-n">
					<div class="page-header">
						<h1>Top N</h1>
						<a href="javascript:;">To top <i class="icon-arrow-up"></i></a>
					</div>
				</section>


				<h3>Syntax Review</h3>





				<div class="syntax">

					<p>You can retrieve just the top results for a query using a Top N query.</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Top N Query Example
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-1844728729" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-1844728729" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-1844728729" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-1844728729" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-1844728729">
										<pre class="prettyprint linenums">select top 10    *
from             Movies
order by         Revenue desc</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-1844728729">
										<pre class="prettyprint linenums">select    *
from      ( select    *
            from      Movies
            order by  Revenue desc )
where     rownum <= 10</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-1844728729">
										<pre class="prettyprint linenums">select    *
from      Movies
order by  Revenue desc
limit     10</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-1844728729">
										<pre class="prettyprint linenums">select    *
from      Movies
order by  Revenue desc
limit     10</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>





				<div class="syntax">

					<p>You can page results from a query using a paged query.</p>



					<div class="panel panel-default top30 bottom30">
						<div class="panel-heading">
							Paged Results Example
						</div>
						<div class="panel-body">
							<div>


								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#sql-server-2047728785" role="tab"
											data-toggle="tab">Microsoft SQL Server</a></li>
									<li role="presentation"><a href="#oracle-2047728785" role="tab"
											data-toggle="tab">Oracle</a></li>
									<li role="presentation"><a href="#mysql-2047728785" role="tab"
											data-toggle="tab">MySQL</a></li>
									<li role="presentation"><a href="#postgres-2047728785" role="tab"
											data-toggle="tab">Postgres</a></li>
								</ul>

								<div class="tab-content">
									<div role="tabpanel" class="tab-pane active" id="sql-server-2047728785">
										<pre class="prettyprint linenums">select    *
from      Movies
order by  Revenue desc
offset    10 rows fetch next 10 rows only</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="oracle-2047728785">
										<pre class="prettyprint linenums">select    *
from      ( select    a.*,
                      rownum as rnum
            from      ( select    *
                        from      Movies
                        order by  Revenue desc ) a )
where     rnum between 10 and 20</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="mysql-2047728785">
										<pre class="prettyprint linenums">select    *
from      Movies
order by  Revenue desc
limit     10, 10</pre>
									</div>
									<div role="tabpanel" class="tab-pane " id="postgres-2047728785">
										<pre class="prettyprint linenums">select    *
from      Movies
order by  Revenue desc
limit     10
offset    10</pre>
									</div>
								</div>


							</div>
						</div>
					</div>

				</div>




				<h3>Exercises</h3>







				<div class="exercise bottom20">

					<ol>
						<li>Select the top 10 products based on price in descending order.</li>
					</ol>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-185227837" aria-expanded="false"
						aria-controls="collapse-aria-controls-185227837">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-185227837">


						<ul class="nav nav-tabs" role="tablist">
							<li role="presentation" class="active"><a href="#sql-server-185227837" role="tab"
									data-toggle="tab">Microsoft SQL Server</a></li>
							<li role="presentation"><a href="#oracle-185227837" role="tab" data-toggle="tab">Oracle</a>
							</li>
							<li role="presentation"><a href="#mysql-185227837" role="tab" data-toggle="tab">MySQL</a>
							</li>
							<li role="presentation"><a href="#postgres-185227837" role="tab"
									data-toggle="tab">Postgres</a></li>
						</ul>

						<div class="tab-content">
							<div role="tabpanel" class="tab-pane active" id="sql-server-185227837">
								<pre class="prettyprint linenums">select top 10    *
from             Inventory.Products
order by         UnitPrice desc</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="oracle-185227837">
								<pre class="prettyprint linenums">select    *
from      ( select    *
            from      Inventory.Products
            order by  UnitPrice desc ) a
where     rownum <= 10</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="mysql-185227837">
								<pre class="prettyprint linenums">select    *
from      Inventory.Products
order by  UnitPrice desc
limit     10</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="postgres-185227837">
								<pre class="prettyprint linenums">select    *
from      Inventory.Products
order by  UnitPrice desc
limit     10</pre>
							</div>
						</div>


					</div>

				</div>





				<div class="exercise bottom20">

					<ol start="2">
						<li>Select the:</li>
					</ol>
					<ul>
						<li>Customer Id</li>
						<li>Customer Name</li>
						<li>Total Sales</li>
					</ul>
					<p>in descending order. Take only the 11th to the 20th customers.</p>



					<button class="btn btn-success" type="button" data-toggle="collapse"
						data-target="#collapse-id-1774923195" aria-expanded="false"
						aria-controls="collapse-aria-controls-1774923195">
						Show Solution
					</button>

					<div class="collapse top20" id="collapse-id-1774923195">


						<ul class="nav nav-tabs" role="tablist">
							<li role="presentation" class="active"><a href="#sql-server-1774923195" role="tab"
									data-toggle="tab">Microsoft SQL Server</a></li>
							<li role="presentation"><a href="#oracle-1774923195" role="tab" data-toggle="tab">Oracle</a>
							</li>
							<li role="presentation"><a href="#mysql-1774923195" role="tab" data-toggle="tab">MySQL</a>
							</li>
							<li role="presentation"><a href="#postgres-1774923195" role="tab"
									data-toggle="tab">Postgres</a></li>
						</ul>

						<div class="tab-content">
							<div role="tabpanel" class="tab-pane active" id="sql-server-1774923195">
								<pre class="prettyprint linenums">select    A.CustomerID as CustomerID,
          A.CompanyName as CompanyName,
          Sum(C.UnitPrice * C.Quantity) as Total
from      ((Sales.Customers A
            Join Sales.Orders B on (A.CustomerID = B.CustomerID))
           Join Sales.[Order Details] C on (B.OrderID = C.OrderID))
group by  A.CustomerID,
          A.CompanyName
order by  Sum(C.UnitPrice * C.Quantity) desc
offset    10 rows fetch next 10 rows only</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="oracle-1774923195">
								<pre class="prettyprint linenums">select    E.CustomerId,
          E.CompanyName,
          E.Total
from      ( select    D.*,
                      rownum as rownumber
            from      ( select    A.CustomerID as CustomerID,
                                  A.CompanyName as CompanyName,
                                  Sum(C.UnitPrice * C.Quantity) as Total
                        from      ((Sales.Customers A
                                    Join Sales.Orders B on (A.CustomerID = B.CustomerID))
                                   Join Sales."Order Details" C on (B.OrderID = C.OrderID))
                        group by  A.CustomerID,
                                  A.CompanyName
                        order by  Sum(C.UnitPrice * C.Quantity) desc ) D ) E
where     E.rownumber between 11 and 20</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="mysql-1774923195">
								<pre class="prettyprint linenums">select    A.CustomerID as CustomerID,
          A.CompanyName as CompanyName,
          Sum(C.UnitPrice * C.Quantity) as Total
from      ((Sales.Customers A
            Join Sales.Orders B on (A.CustomerID = B.CustomerID))
           Join Sales.`Order Details` C on (B.OrderID = C.OrderID))
group by  A.CustomerID,
          A.CompanyName
order by  Sum(C.UnitPrice * C.Quantity) desc
limit     10, 10</pre>
							</div>
							<div role="tabpanel" class="tab-pane " id="postgres-1774923195">
								<pre class="prettyprint linenums">select    A.CustomerID as CustomerID,
          A.CompanyName as CompanyName,
          Sum(C.UnitPrice * C.Quantity) as Total
from      ((Sales.Customers A
            Join Sales.Orders B on (A.CustomerID = B.CustomerID))
           Join Sales."Order Details" C on (B.OrderID = C.OrderID))
group by  A.CustomerID,
          A.CompanyName
order by  Sum(C.UnitPrice * C.Quantity) desc
limit     10
offset    10</pre>
							</div>
						</div>


					</div>

				</div>






			</div>
		</div>

	</div>
	<!-- END -->
	<footer class="footer">
		<div class="container container-narrow">
			<p>SQL. Brought to you by the team at <a href="http://www.bnextconsulting.com"
					target="_blank">bnextconsulting</a>
		</div>
	</footer>
	<!-- Le javascript
    ================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="assets/js/jquery-1.8.3.min.js"></script>
	<script src="assets/js/bootstrap.min.js"></script>
	<script src="assets/google-code-prettify/prettify.js"></script>
	<script src="assets/js/application.js"></script>
</body>

</html>